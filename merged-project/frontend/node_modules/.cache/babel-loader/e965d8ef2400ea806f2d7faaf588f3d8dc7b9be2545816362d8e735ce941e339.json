{"ast":null,"code":"import _objectSpread from\"/media/dh77b/New Volume/smartdaycare/merged-project/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// import React, { useEffect, useMemo, useState } from \"react\";\n// import {\n//   ArrowPathIcon,\n//   MagnifyingGlassIcon,\n//   UserPlusIcon,\n//   TrashIcon,\n// } from \"@heroicons/react/24/outline\";\n// import API from \"../utils/api\";\n// import { AuthContext } from \"../context/AuthContext\";\n// const STAFF_ROLES = [\n//   { value: \"caregiver\", label: \"Caregiver\" },\n//   { value: \"teacher\", label: \"Teacher\" },\n//   { value: \"cook\", label: \"Cook\" },\n// ];\n// const roleBadge = (staffRole) => {\n//   const v = String(staffRole || \"\").toLowerCase();\n//   if (v === \"teacher\") return \"bg-indigo-50 text-indigo-700 border-indigo-200\";\n//   if (v === \"cook\") return \"bg-amber-50 text-amber-700 border-amber-200\";\n//   return \"bg-emerald-50 text-emerald-700 border-emerald-200\"; // caregiver default\n// };\n// const fmtDate = (d) => (d ? new Date(d).toLocaleDateString() : \"-\");\n// export default function AdminDashboard() {\n//   const { user, logout } = React.useContext(AuthContext);\n//   const [staffList, setStaffList] = useState([]);\n//   const [loading, setLoading] = useState(true);\n//   const [creating, setCreating] = useState(false);\n//   const [status, setStatus] = useState(null); // {type, msg}\n//   const [query, setQuery] = useState(\"\");\n//   const [roleFilter, setRoleFilter] = useState(\"all\");\n//   const [form, setForm] = useState({\n//     name: \"\",\n//     email: \"\",\n//     phone: \"\",\n//     staffRole: \"\",\n//     experience: \"\",\n//     joiningDate: \"\",\n//   });\n//   const fetchStaff = async () => {\n//     setLoading(true);\n//     setStatus(null);\n//     try {\n//       const res = await API.get(\"/users/staff\");\n//       setStaffList(res.data?.data || []);\n//       console.log(res.data);\n//     } catch (e) {\n//       console.error(e);\n//       setStatus({ type: \"error\", msg: \"Failed to load staff list.\" });\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n//   useEffect(() => {\n//     fetchStaff();\n//   }, []);\n//   const stats = useMemo(() => {\n//     const total = staffList.length;\n//     const caregiver = staffList.filter(\n//       (s) => s.staffRole === \"caregiver\"\n//     ).length;\n//     const teacher = staffList.filter((s) => s.staffRole === \"teacher\").length;\n//     const cook = staffList.filter((s) => s.staffRole === \"cook\").length;\n//     return { total, caregiver, teacher, cook };\n//   }, [staffList]);\n//   const filtered = useMemo(() => {\n//     const q = query.trim().toLowerCase();\n//     return staffList\n//       .filter((s) => {\n//         if (roleFilter !== \"all\" && s.staffRole !== roleFilter) return false;\n//         if (!q) return true;\n//         const hay = `${s.name || \"\"} ${s.email || \"\"} ${\n//           s.phone || \"\"\n//         }`.toLowerCase();\n//         return hay.includes(q);\n//       })\n//       .slice()\n//       .sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\n//   }, [staffList, query, roleFilter]);\n//   const handleCreateStaff = async (e) => {\n//     e.preventDefault();\n//     setStatus(null);\n//     setCreating(true);\n//     try {\n//       const payload = {\n//         name: form.name.trim(),\n//         email: form.email.trim(),\n//         phone: form.phone.trim(),\n//         staffRole: form.staffRole,\n//         experience:\n//           form.experience === \"\" ? undefined : Number(form.experience),\n//         joiningDate: form.joiningDate || undefined,\n//       };\n//       console.log(payload);\n//       const res = await API.post(\"/users/staff\", payload);\n//       const created = res.data?.data;\n//       const tempPassword = res.data?.tempPassword;\n//       setStaffList((prev) => [created, ...prev].filter(Boolean));\n//       setForm({\n//         name: \"\",\n//         email: \"\",\n//         phone: \"\",\n//         staffRole: \"caregiver\",\n//         experience: \"\",\n//         joiningDate: \"\",\n//       });\n//       setStatus({\n//         type: \"success\",\n//         msg: tempPassword\n//           ? `Staff created. Temporary password: ${tempPassword} (share this with staff to log in).`\n//           : \"Staff created successfully.\",\n//       });\n//     } catch (err) {\n//       console.error(err);\n//       setStatus({\n//         type: \"error\",\n//         msg: err.response?.data?.error || \"Failed to create staff.\",\n//       });\n//     } finally {\n//       setCreating(false);\n//     }\n//   };\n//   const deleteStaff = async (id) => {\n//     if (!window.confirm(\"Remove this staff member?\")) return;\n//     try {\n//       await API.delete(`/users/${id}`);\n//       setStaffList((prev) => prev.filter((s) => s._id !== id));\n//     } catch (err) {\n//       console.error(err);\n//       setStatus({ type: \"error\", msg: \"Failed to delete staff.\" });\n//     }\n//   };\n//   // Handle Admin Request for User\n//   const handleAdminRequest = async (id) => {\n//     try {\n//       const res = await API.post(`/users/request-admin/${id}`);\n//       alert(res.data?.message || \"Admin request submitted successfully.\");\n//     } catch (err) {\n//       alert(\"Failed to submit admin request.\");\n//     }\n//   };\n//   return (\n//     <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50\">\n//       {/* Top bar */}\n//       <div className=\"sticky top-0 z-10 border-b bg-white/80 backdrop-blur\">\n//         <div className=\"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between\">\n//           <div>\n//             <h1 className=\"text-2xl font-bold text-slate-900\">Admin Portal</h1>\n//             <p className=\"text-sm text-slate-600\">\n//               Staff management • roles • onboarding\n//             </p>\n//           </div>\n//           <div className=\"flex items-center gap-3\">\n//             <div className=\"hidden sm:block text-right\">\n//               <div className=\"text-sm font-semibold text-slate-900\">\n//                 {user?.name || \"Admin\"}\n//               </div>\n//               <div className=\"text-xs text-slate-500\">{user?.email}</div>\n//             </div>\n//             <button\n//               onClick={logout}\n//               className=\"px-4 py-2 rounded-xl bg-slate-900 text-white hover:bg-slate-800 transition\"\n//             >\n//               Logout\n//             </button>\n//           </div>\n//         </div>\n//       </div>\n//       <div className=\"max-w-7xl mx-auto px-4 py-8\">\n//         {/* Status */}\n//         {status?.type && (\n//           <div\n//             className={`mb-6 rounded-2xl border px-4 py-3 text-sm shadow-sm ${\n//               status.type === \"success\"\n//                 ? \"bg-emerald-50 text-emerald-800 border-emerald-200\"\n//                 : \"bg-rose-50 text-rose-800 border-rose-200\"\n//             }`}\n//           >\n//             {status.msg}\n//           </div>\n//         )}\n//         {/* Stats */}\n//         <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n//           <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n//             <div className=\"text-xs text-slate-500\">Total Staff</div>\n//             <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n//               {stats.total}\n//             </div>\n//           </div>\n//           <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n//             <div className=\"text-xs text-slate-500\">Caregivers</div>\n//             <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n//               {stats.caregiver}\n//             </div>\n//           </div>\n//           <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n//             <div className=\"text-xs text-slate-500\">Teachers</div>\n//             <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n//               {stats.teacher}\n//             </div>\n//           </div>\n//           <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n//             <div className=\"text-xs text-slate-500\">Cooks</div>\n//             <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n//               {stats.cook}\n//             </div>\n//           </div>\n//         </div>\n//         <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n//           {/* Create staff */}\n//           <div className=\"lg:col-span-1\">\n//             <div className=\"rounded-2xl border bg-white shadow-sm overflow-hidden\">\n//               <div className=\"px-6 py-5 border-b flex items-center gap-3\">\n//                 <div className=\"p-2 rounded-xl bg-indigo-50 border border-indigo-100\">\n//                   <UserPlusIcon className=\"h-5 w-5 text-indigo-700\" />\n//                 </div>\n//                 <div>\n//                   <h2 className=\"font-semibold text-slate-900\">Add Staff</h2>\n//                   <p className=\"text-xs text-slate-500\">\n//                     Create a staff account with a sub-role\n//                   </p>\n//                 </div>\n//               </div>\n//               <form onSubmit={handleCreateStaff} className=\"p-6 space-y-4\">\n//                 <div>\n//                   <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                     Full Name\n//                   </label>\n//                   <input\n//                     value={form.name}\n//                     onChange={(e) => setForm({ ...form, name: e.target.value })}\n//                     required\n//                     className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     placeholder=\"e.g., Ayesha Rahman\"\n//                   />\n//                 </div>\n//                 <div>\n//                   <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                     Email\n//                   </label>\n//                   <input\n//                     type=\"email\"\n//                     value={form.email}\n//                     onChange={(e) =>\n//                       setForm({ ...form, email: e.target.value })\n//                     }\n//                     required\n//                     className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     placeholder=\"e.g., staff@daycare.com\"\n//                   />\n//                 </div>\n//                 <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n//                   <div>\n//                     <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                       Phone\n//                     </label>\n//                     <input\n//                       value={form.phone}\n//                       onChange={(e) =>\n//                         setForm({ ...form, phone: e.target.value })\n//                       }\n//                       className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                       placeholder=\"017XXXXXXXX\"\n//                     />\n//                   </div>\n//                   <div>\n//                     <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                       Staff Role\n//                     </label>\n//                     <select\n//                       value={form.staffRole}\n//                       onChange={(e) =>\n//                         setForm({ ...form, staffRole: e.target.value })\n//                       }\n//                       className=\"w-full rounded-xl border px-3 py-2.5 bg-white focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     >\n//                       {STAFF_ROLES.map((r) => (\n//                         <option key={r.value} value={r.value}>\n//                           {r.label}\n//                         </option>\n//                       ))}\n//                     </select>\n//                   </div>\n//                 </div>\n//                 <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n//                   <div>\n//                     <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                       Experience (years)\n//                     </label>\n//                     <input\n//                       type=\"number\"\n//                       min=\"0\"\n//                       value={form.experience}\n//                       onChange={(e) =>\n//                         setForm({ ...form, experience: e.target.value })\n//                       }\n//                       className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                       placeholder=\"e.g., 3\"\n//                     />\n//                   </div>\n//                   <div>\n//                     <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                       Joining Date\n//                     </label>\n//                     <input\n//                       type=\"date\"\n//                       value={form.joiningDate}\n//                       onChange={(e) =>\n//                         setForm({ ...form, joiningDate: e.target.value })\n//                       }\n//                       className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     />\n//                   </div>\n//                 </div>\n//                 <button\n//                   type=\"submit\"\n//                   disabled={creating}\n//                   className=\"w-full rounded-xl bg-indigo-600 text-white py-2.5 font-semibold hover:bg-indigo-700 disabled:opacity-60 transition\"\n//                 >\n//                   {creating ? \"Creating...\" : \"Create Staff\"}\n//                 </button>\n//                 <p className=\"text-xs text-slate-500\">\n//                   Tip: a temporary password is generated automatically. Share it\n//                   with the staff member so they can log in.\n//                 </p>\n//               </form>\n//             </div>\n//           </div>\n//           {/* Staff table */}\n//           <div className=\"lg:col-span-2\">\n//             <div className=\"rounded-2xl border bg-white shadow-sm overflow-hidden\">\n//               <div className=\"px-6 py-5 border-b flex flex-col sm:flex-row sm:items-center gap-4 sm:justify-between\">\n//                 <div>\n//                   <h2 className=\"font-semibold text-slate-900\">\n//                     Staff Directory\n//                   </h2>\n//                   <p className=\"text-xs text-slate-500\">\n//                     Search, filter, and manage staff accounts\n//                   </p>\n//                 </div>\n//                 <div className=\"flex items-center gap-3\">\n//                   <div className=\"relative\">\n//                     <MagnifyingGlassIcon className=\"h-5 w-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2\" />\n//                     <input\n//                       value={query}\n//                       onChange={(e) => setQuery(e.target.value)}\n//                       placeholder=\"Search name, email, phone\"\n//                       className=\"pl-10 pr-3 py-2.5 rounded-xl border w-72 max-w-full focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     />\n//                   </div>\n//                   <select\n//                     value={roleFilter}\n//                     onChange={(e) => setRoleFilter(e.target.value)}\n//                     className=\"py-2.5 rounded-xl border bg-white px-3 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                   >\n//                     <option value=\"all\">All roles</option>\n//                     {STAFF_ROLES.map((r) => (\n//                       <option key={r.value} value={r.value}>\n//                         {r.label}\n//                       </option>\n//                     ))}\n//                   </select>\n//                   <button\n//                     onClick={fetchStaff}\n//                     className=\"inline-flex items-center gap-2 px-3 py-2.5 rounded-xl border hover:bg-slate-50 transition\"\n//                     title=\"Refresh\"\n//                   >\n//                     <ArrowPathIcon className=\"h-5 w-5\" />\n//                     <span className=\"hidden sm:inline\">Refresh</span>\n//                   </button>\n//                 </div>\n//               </div>\n//               {loading ? (\n//                 <div className=\"py-10 text-center text-slate-500\">\n//                   Loading staff…\n//                 </div>\n//               ) : filtered.length === 0 ? (\n//                 <div className=\"py-10 text-center text-slate-500\">\n//                   No staff found. Try changing your search/filter.\n//                 </div>\n//               ) : (\n//                 <div className=\"overflow-x-auto\">\n//                   <table className=\"min-w-full text-sm\">\n//                     <thead>\n//                       <tr className=\"text-left bg-slate-50 border-b\">\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Staff\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Role\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Contact\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Experience\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Joining\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Added\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Actions\n//                         </th>\n//                       </tr>\n//                     </thead>\n//                     <tbody>\n//                       {filtered.map((s) => (\n//                         <tr\n//                           key={s._id}\n//                           className=\"border-b last:border-b-0 hover:bg-slate-50/60\"\n//                         >\n//                           <td className=\"py-3.5 px-4\">\n//                             <div className=\"font-semibold text-slate-900\">\n//                               {s.name}\n//                             </div>\n//                             <div className=\"text-xs text-slate-500\">\n//                               {s.email}\n//                             </div>\n//                           </td>\n//                           <td className=\"py-3.5 px-4\">\n//                             <span\n//                               className={`inline-flex items-center px-2.5 py-1 rounded-full border text-xs font-semibold ${roleBadge(\n//                                 s.staffRole\n//                               )}`}\n//                             >\n//                               {String(s.staffRole).toUpperCase()}\n//                             </span>\n//                           </td>\n//                           <td className=\"py-3.5 px-4 text-slate-700\">\n//                             {s.phone || \"-\"}\n//                           </td>\n//                           <td className=\"py-3.5 px-4 text-slate-700\">\n//                             {s.experience === 0 || s.experience\n//                               ? `${s.experience} yrs`\n//                               : \"-\"}\n//                           </td>\n//                           <td className=\"py-3.5 px-4 text-slate-700\">\n//                             {fmtDate(s.joiningDate)}\n//                           </td>\n//                           <td className=\"py-3.5 px-4 text-slate-700\">\n//                             {fmtDate(s.createdAt)}\n//                           </td>\n//                           <td className=\"py-3.5 px-4\">\n//                             {s.role === \"parent\" && (\n//                               <button\n//                                 onClick={() => handleAdminRequest(s._id)}\n//                                 className=\"inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition\"\n//                               >\n//                                 Request Admin\n//                               </button>\n//                             )}\n//                             <button\n//                               onClick={() => deleteStaff(s._id)}\n//                               className=\"inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-rose-600 text-white hover:bg-rose-700 transition\"\n//                               title=\"Delete\"\n//                             >\n//                               <TrashIcon className=\"h-4 w-4\" />\n//                               Delete\n//                             </button>\n//                           </td>\n//                         </tr>\n//                       ))}\n//                     </tbody>\n//                   </table>\n//                 </div>\n//               )}\n//             </div>\n//           </div>\n//         </div>\n//       </div>\n//     </div>\n//   );\n// }\nimport React,{useEffect,useMemo,useState}from\"react\";import{ArrowPathIcon,MagnifyingGlassIcon,UserPlusIcon,TrashIcon}from\"@heroicons/react/24/outline\";import API from\"../utils/api\";import{AuthContext}from\"../context/AuthContext\";import'../styles.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const STAFF_ROLES=[{value:\"caregiver\",label:\"Caregiver\"},{value:\"teacher\",label:\"Teacher\"},{value:\"cook\",label:\"Cook\"}];const roleBadge=staffRole=>{const v=String(staffRole||\"\").toLowerCase();if(v===\"teacher\")return\"bg-indigo-50 text-indigo-700 border-indigo-200\";if(v===\"cook\")return\"bg-amber-50 text-amber-700 border-amber-200\";return\"bg-emerald-50 text-emerald-700 border-emerald-200\";// caregiver default\n};const fmtDate=d=>d?new Date(d).toLocaleDateString():\"-\";export default function AdminDashboard(){const{user,logout}=React.useContext(AuthContext);// Staff state\nconst[staffList,setStaffList]=useState([]);const[loading,setLoading]=useState(true);const[creating,setCreating]=useState(false);const[status,setStatus]=useState(null);// {type, msg}\nconst[query,setQuery]=useState(\"\");const[roleFilter,setRoleFilter]=useState(\"all\");const[form,setForm]=useState({name:\"\",email:\"\",phone:\"\",staffRole:\"caregiver\",experience:\"\",joiningDate:\"\"});// Children state\nconst[children,setChildren]=useState([]);const[childrenLoading,setChildrenLoading]=useState(true);const[assigningId,setAssigningId]=useState(null);// childId while assigning\n// Staff Activities state\nconst[staffActivities,setStaffActivities]=useState([]);const[activitiesLoading,setActivitiesLoading]=useState(true);// Fetch staff activities\nconst fetchStaffActivities=async()=>{setActivitiesLoading(true);try{const res=await API.get(\"/admin/staff-record\");// Sort by latest first\nconst sorted=(res.data.data||[]).sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));setStaffActivities(sorted);}catch(err){console.error(\"Failed to fetch staff activities:\",err);setStatus({type:\"error\",msg:\"Failed to load staff activity records.\"});setStaffActivities([]);}finally{setActivitiesLoading(false);}};// Fetch on mount (add to existing useEffect)\n// Fetch staff\nconst fetchStaff=async()=>{setLoading(true);setStatus(null);try{var _res$data;const res=await API.get(\"/users/staff\");setStaffList(((_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.data)||[]);}catch(e){console.error(e);setStatus({type:\"error\",msg:\"Failed to load staff list.\"});}finally{setLoading(false);}};// Fetch children\nconst fetchChildren=async()=>{setChildrenLoading(true);try{const res=await API.get(\"/admin/getallchildren\");setChildren(res.data||[]);}catch(err){console.error(err);setStatus({type:\"error\",msg:\"Failed to load children.\"});}finally{setChildrenLoading(false);}};useEffect(()=>{fetchStaff();fetchChildren();fetchStaffActivities();},[]);// Staff stats\nconst stats=useMemo(()=>{const total=staffList.length;const caregiver=staffList.filter(s=>s.staffRole===\"caregiver\").length;const teacher=staffList.filter(s=>s.staffRole===\"teacher\").length;const cook=staffList.filter(s=>s.staffRole===\"cook\").length;return{total,caregiver,teacher,cook};},[staffList]);// Filtered staff\nconst filtered=useMemo(()=>{const q=query.trim().toLowerCase();return staffList.filter(s=>{if(roleFilter!==\"all\"&&s.staffRole!==roleFilter)return false;if(!q)return true;const hay=\"\".concat(s.name||\"\",\" \").concat(s.email||\"\",\" \").concat(s.phone||\"\").toLowerCase();return hay.includes(q);}).slice().sort((a,b)=>new Date(b.createdAt||0)-new Date(a.createdAt||0));},[staffList,query,roleFilter]);// List of caregivers only (for dropdown)\nconst caregivers=useMemo(()=>{return staffList.filter(s=>s.staffRole===\"caregiver\").sort((a,b)=>a.name.localeCompare(b.name));},[staffList]);// Create staff\nconst handleCreateStaff=async e=>{e.preventDefault();setStatus(null);setCreating(true);try{var _res$data2,_res$data3;const payload={name:form.name.trim(),email:form.email.trim(),phone:form.phone.trim(),staffRole:form.staffRole,experience:form.experience===\"\"?undefined:Number(form.experience),joiningDate:form.joiningDate||undefined};const res=await API.post(\"/users/staff\",payload);const created=(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.data;const tempPassword=(_res$data3=res.data)===null||_res$data3===void 0?void 0:_res$data3.tempPassword;setStaffList(prev=>[created,...prev].filter(Boolean));setForm({name:\"\",email:\"\",phone:\"\",staffRole:\"caregiver\",experience:\"\",joiningDate:\"\"});setStatus({type:\"success\",msg:tempPassword?\"Staff created. Temporary password: \".concat(tempPassword):\"Staff created successfully.\"});}catch(err){var _err$response,_err$response$data;console.error(err);setStatus({type:\"error\",msg:((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||\"Failed to create staff.\"});}finally{setCreating(false);}};// Delete staff\nconst deleteStaff=async id=>{if(!window.confirm(\"Remove this staff member?\"))return;try{await API.delete(\"/users/\".concat(id));setStaffList(prev=>prev.filter(s=>s._id!==id));setStatus({type:\"success\",msg:\"Staff deleted.\"});}catch(err){console.error(err);setStatus({type:\"error\",msg:\"Failed to delete staff.\"});}};// Assign caregiver\nconst handleAssignCaregiver=async(childId,caregiverId)=>{// Allow empty string to unassign\nsetAssigningId(childId);try{await API.post(\"/admin/assign-caregiver\",{childId,caregiverId:caregiverId||null// backend should handle null/empty as unassign if needed\n});setChildren(prev=>prev.map(c=>c._id===childId?_objectSpread(_objectSpread({},c),{},{caregiver:caregiverId||null}):c));setStatus({type:\"success\",msg:\"Caregiver assigned successfully!\"});}catch(err){var _err$response2,_err$response2$data;console.error(err);setStatus({type:\"error\",msg:((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||\"Failed to assign caregiver.\"});}finally{setAssigningId(null);}};const handleUpdateCaregiver=async(childId,caregiverId)=>{setAssigningId(childId);try{await API.put(\"/admin/assign-caregiver/\".concat(childId),{caregiverId:caregiverId||null});// Update local state\nsetChildren(prev=>prev.map(c=>c._id===childId?_objectSpread(_objectSpread({},c),{},{caregiver:caregiverId}):c));setStatus({type:\"success\",msg:caregiverId?\"Caregiver assigned successfully!\":\"Caregiver removed successfully!\"});}catch(err){var _err$response3,_err$response3$data;console.error(err);setStatus({type:\"error\",msg:((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.error)||\"Failed to update caregiver.\"});}finally{setAssigningId(null);}};// Helper to get caregiver name\nconst getCaregiverName=caregiverId=>{if(!caregiverId)return\"None\";const cg=staffList.find(s=>s._id===caregiverId);return cg?cg.name:\"Unknown\";};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen\",style:{background:'linear-gradient(135deg, #f5cfcf 0%, #dbbfbf 100%)'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"sticky top-0 z-10 border-b bg-white/80 backdrop-blur\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-slate-900\",children:\"Admin Portal\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-slate-600\",children:\"Staff management \\u2022 children \\u2022 caregiver assignment\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"hidden sm:block text-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold text-slate-900\",children:(user===null||user===void 0?void 0:user.name)||\"Admin\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-slate-500\",children:user===null||user===void 0?void 0:user.email})]}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,className:\"px-4 py-2 rounded-xl bg-slate-900 text-white hover:bg-slate-800 transition\",children:\"Logout\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 py-8\",children:[(status===null||status===void 0?void 0:status.type)&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 rounded-2xl border px-4 py-3 text-sm shadow-sm \".concat(status.type===\"success\"?\"bg-emerald-50 text-emerald-800 border-emerald-200\":\"bg-rose-50 text-rose-800 border-rose-200\"),children:status.msg}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl border bg-white p-5 shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-slate-500\",children:\"Total Staff\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-3xl font-bold text-slate-900\",children:stats.total})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl border bg-white p-5 shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-slate-500\",children:\"Caregivers\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-3xl font-bold text-slate-900\",children:stats.caregiver})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl border bg-white p-5 shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-slate-500\",children:\"Teachers\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-3xl font-bold text-slate-900\",children:stats.teacher})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl border bg-white p-5 shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-slate-500\",children:\"Cooks\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-3xl font-bold text-slate-900\",children:stats.cook})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl border bg-white shadow-sm overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-5 border-b flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-xl bg-indigo-50 border border-indigo-100\",children:/*#__PURE__*/_jsx(UserPlusIcon,{className:\"h-5 w-5 text-indigo-700\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-slate-900\",children:\"Add Staff\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500\",children:\"Create a staff account with a sub-role\"})]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCreateStaff,className:\"p-6 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-semibold text-slate-700 mb-1\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{value:form.name,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{name:e.target.value})),required:true,className:\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\",placeholder:\"e.g., Ayesha Rahman\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-semibold text-slate-700 mb-1\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:form.email,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{email:e.target.value})),required:true,className:\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\",placeholder:\"e.g., staff@daycare.com\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-semibold text-slate-700 mb-1\",children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{value:form.phone,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{phone:e.target.value})),className:\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\",placeholder:\"017XXXXXXXX\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-semibold text-slate-700 mb-1\",children:\"Staff Role\"}),/*#__PURE__*/_jsx(\"select\",{value:form.staffRole,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{staffRole:e.target.value})),className:\"w-full rounded-xl border px-3 py-2.5 bg-white focus:outline-none focus:ring-2 focus:ring-indigo-200\",children:STAFF_ROLES.map(r=>/*#__PURE__*/_jsx(\"option\",{value:r.value,children:r.label},r.value))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-semibold text-slate-700 mb-1\",children:\"Experience (years)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:form.experience,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{experience:e.target.value})),className:\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\",placeholder:\"e.g., 3\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-semibold text-slate-700 mb-1\",children:\"Joining Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:form.joiningDate,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{joiningDate:e.target.value})),className:\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:creating,className:\"w-full rounded-xl bg-indigo-600 text-white py-2.5 font-semibold hover:bg-indigo-700 disabled:opacity-60 transition\",children:creating?\"Creating...\":\"Create Staff\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500\",children:\"A temporary password will be generated and shown after creation.\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl border bg-white shadow-sm overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-5 border-b flex flex-col sm:flex-row sm:items-center gap-4 sm:justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-slate-900\",children:\"Staff Directory\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500\",children:\"Search, filter, and manage staff accounts\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(MagnifyingGlassIcon,{className:\"h-5 w-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2\"}),/*#__PURE__*/_jsx(\"input\",{value:query,onChange:e=>setQuery(e.target.value),placeholder:\"Search name, email, phone\",className:\"pl-10 pr-3 py-2.5 rounded-xl border w-72 max-w-full focus:outline-none focus:ring-2 focus:ring-indigo-200\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:roleFilter,onChange:e=>setRoleFilter(e.target.value),className:\"py-2.5 rounded-xl border bg-white px-3 focus:outline-none focus:ring-2 focus:ring-indigo-200\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All roles\"}),STAFF_ROLES.map(r=>/*#__PURE__*/_jsx(\"option\",{value:r.value,children:r.label},r.value))]}),/*#__PURE__*/_jsxs(\"button\",{onClick:fetchStaff,className:\"inline-flex items-center gap-2 px-3 py-2.5 rounded-xl border hover:bg-slate-50 transition\",title:\"Refresh\",children:[/*#__PURE__*/_jsx(ArrowPathIcon,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"Refresh\"})]})]})]}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"py-10 text-center text-slate-500\",children:\"Loading staff\\u2026\"}):filtered.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"py-10 text-center text-slate-500\",children:\"No staff found.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-left bg-slate-50 border-b\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Staff\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Contact\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Experience\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Joining\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Added\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filtered.map(s=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b last:border-b-0 hover:bg-slate-50/60\",children:[/*#__PURE__*/_jsxs(\"td\",{className:\"py-3.5 px-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-slate-900\",children:s.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-slate-500\",children:s.email})]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-1 rounded-full border text-xs font-semibold \".concat(roleBadge(s.staffRole)),children:String(s.staffRole).toUpperCase()})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4 text-slate-700\",children:s.phone||\"-\"}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4 text-slate-700\",children:s.experience!==undefined?\"\".concat(s.experience,\" yrs\"):\"-\"}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4 text-slate-700\",children:fmtDate(s.joiningDate)}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4 text-slate-700\",children:fmtDate(s.createdAt)}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>deleteStaff(s._id),className:\"inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-rose-600 text-white hover:bg-rose-700 transition text-sm\",children:[/*#__PURE__*/_jsx(TrashIcon,{className:\"h-4 w-4\"}),\"Delete\"]})})]},s._id))})]})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl border bg-white shadow-sm overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-5 border-b flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-xl bg-emerald-50 border border-emerald-100\",children:/*#__PURE__*/_jsx(UserPlusIcon,{className:\"h-5 w-5 text-emerald-700\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-slate-900\",children:\"Children & Caregiver Management\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500\",children:\"Assign, update, or remove caregivers for each child\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:fetchChildren,className:\"inline-flex items-center gap-2 px-3 py-2.5 rounded-xl border hover:bg-slate-50 transition\",children:[/*#__PURE__*/_jsx(ArrowPathIcon,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"Refresh\"})]})]}),childrenLoading?/*#__PURE__*/_jsx(\"div\",{className:\"py-10 text-center text-slate-500\",children:\"Loading children\\u2026\"}):children.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"py-10 text-center text-slate-500\",children:\"No children registered yet.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-left bg-slate-50 border-b\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Child\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Date of Birth\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Parent\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Current Caregiver\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:children.map(child=>{var _child$parent;return/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b last:border-b-0 hover:bg-slate-50/60\",children:[/*#__PURE__*/_jsxs(\"td\",{className:\"py-3.5 px-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-slate-900\",children:child.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-slate-500\",children:[\"ID: \",child._id]})]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4 text-slate-700\",children:child.dateOfBirth?new Date(child.dateOfBirth).toLocaleDateString():\"-\"}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4 text-slate-700\",children:((_child$parent=child.parent)===null||_child$parent===void 0?void 0:_child$parent.name)||\"-\"}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-1 rounded-full border text-xs font-semibold \".concat(child.caregiver?\"bg-emerald-50 text-emerald-700 border-emerald-200\":\"bg-gray-100 text-gray-600 border-gray-300\"),children:getCaregiverName(child.caregiver)})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:child.caregiver||\"\",disabled:assigningId===child._id,onChange:e=>{const newCaregiverId=e.target.value||null;handleUpdateCaregiver(child._id,newCaregiverId);},className:\"rounded-xl border px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-indigo-200\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u2014 No caregiver \\u2014\"}),caregivers.map(cg=>/*#__PURE__*/_jsxs(\"option\",{value:cg._id,children:[cg.name,\" (\",cg.email,\")\"]},cg._id))]}),child.caregiver&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleUpdateCaregiver(child._id,null),disabled:assigningId===child._id,className:\"px-3 py-2 rounded-xl bg-rose-600 text-white text-sm hover:bg-rose-700 disabled:opacity-60 transition flex items-center gap-1.5\",children:[/*#__PURE__*/_jsx(TrashIcon,{className:\"h-4 w-4\"}),\"Remove\"]}),assigningId===child._id&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-slate-500\",children:\"saving\\u2026\"})]})})]},child._id);})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl border bg-white shadow-sm overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-5 border-b flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-xl bg-amber-50 border border-amber-100\",children:/*#__PURE__*/_jsx(ArrowPathIcon,{className:\"h-5 w-5 text-amber-700\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-slate-900\",children:\"Staff Activity Log\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500\",children:\"All recorded activities from caregivers, teachers, and cooks\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:fetchStaffActivities,disabled:activitiesLoading,className:\"inline-flex items-center gap-2 px-3 py-2.5 rounded-xl border hover:bg-slate-50 transition disabled:opacity-60\",children:[/*#__PURE__*/_jsx(ArrowPathIcon,{className:\"h-5 w-5 \".concat(activitiesLoading?\"animate-spin\":\"\")}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"Refresh\"})]})]}),activitiesLoading?/*#__PURE__*/_jsx(\"div\",{className:\"py-10 text-center text-slate-500\",children:\"Loading activities\\u2026\"}):staffActivities.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"py-10 text-center text-slate-500\",children:\"No staff activities recorded yet.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-left bg-slate-50 border-b\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Staff Member\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Activity\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3.5 px-4 font-semibold text-slate-700\",children:\"Timestamp\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:staffActivities.map(activity=>{var _staff$staffRole;const staff=staffList.find(s=>s._id===activity.staffId);return/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b last:border-b-0 hover:bg-slate-50/60\",children:[/*#__PURE__*/_jsxs(\"td\",{className:\"py-3.5 px-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-slate-900\",children:(staff===null||staff===void 0?void 0:staff.name)||\"Unknown Staff\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-slate-500\",children:(staff===null||staff===void 0?void 0:staff.email)||\"-\"})]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-1 rounded-full border text-xs font-semibold \".concat(roleBadge(staff===null||staff===void 0?void 0:staff.staffRole)),children:(staff===null||staff===void 0?void 0:(_staff$staffRole=staff.staffRole)===null||_staff$staffRole===void 0?void 0:_staff$staffRole.toUpperCase())||\"N/A\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4 text-slate-700 font-medium\",children:activity.activityname}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3.5 px-4 text-slate-700\",children:new Date(activity.createdAt).toLocaleString()})]},activity._id);})})]})})]})]})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useState","ArrowPathIcon","MagnifyingGlassIcon","UserPlusIcon","TrashIcon","API","AuthContext","jsx","_jsx","jsxs","_jsxs","STAFF_ROLES","value","label","roleBadge","staffRole","v","String","toLowerCase","fmtDate","d","Date","toLocaleDateString","AdminDashboard","user","logout","useContext","staffList","setStaffList","loading","setLoading","creating","setCreating","status","setStatus","query","setQuery","roleFilter","setRoleFilter","form","setForm","name","email","phone","experience","joiningDate","children","setChildren","childrenLoading","setChildrenLoading","assigningId","setAssigningId","staffActivities","setStaffActivities","activitiesLoading","setActivitiesLoading","fetchStaffActivities","res","get","sorted","data","sort","a","b","createdAt","err","console","error","type","msg","fetchStaff","_res$data","e","fetchChildren","stats","total","length","caregiver","filter","s","teacher","cook","filtered","q","trim","hay","concat","includes","slice","caregivers","localeCompare","handleCreateStaff","preventDefault","_res$data2","_res$data3","payload","undefined","Number","post","created","tempPassword","prev","Boolean","_err$response","_err$response$data","response","deleteStaff","id","window","confirm","delete","_id","handleAssignCaregiver","childId","caregiverId","map","c","_objectSpread","_err$response2","_err$response2$data","handleUpdateCaregiver","put","_err$response3","_err$response3$data","getCaregiverName","cg","find","className","style","background","onClick","onSubmit","onChange","target","required","placeholder","r","min","disabled","title","toUpperCase","child","_child$parent","dateOfBirth","parent","newCaregiverId","activity","_staff$staffRole","staff","staffId","activityname","toLocaleString"],"sources":["/media/dh77b/New Volume/smartdaycare/merged-project/frontend/src/pages/AdminDashboard.js"],"sourcesContent":["// import React, { useEffect, useMemo, useState } from \"react\";\n// import {\n//   ArrowPathIcon,\n//   MagnifyingGlassIcon,\n//   UserPlusIcon,\n//   TrashIcon,\n// } from \"@heroicons/react/24/outline\";\n\n// import API from \"../utils/api\";\n// import { AuthContext } from \"../context/AuthContext\";\n\n// const STAFF_ROLES = [\n//   { value: \"caregiver\", label: \"Caregiver\" },\n//   { value: \"teacher\", label: \"Teacher\" },\n//   { value: \"cook\", label: \"Cook\" },\n// ];\n\n// const roleBadge = (staffRole) => {\n//   const v = String(staffRole || \"\").toLowerCase();\n//   if (v === \"teacher\") return \"bg-indigo-50 text-indigo-700 border-indigo-200\";\n//   if (v === \"cook\") return \"bg-amber-50 text-amber-700 border-amber-200\";\n//   return \"bg-emerald-50 text-emerald-700 border-emerald-200\"; // caregiver default\n// };\n\n// const fmtDate = (d) => (d ? new Date(d).toLocaleDateString() : \"-\");\n\n// export default function AdminDashboard() {\n//   const { user, logout } = React.useContext(AuthContext);\n\n//   const [staffList, setStaffList] = useState([]);\n//   const [loading, setLoading] = useState(true);\n//   const [creating, setCreating] = useState(false);\n//   const [status, setStatus] = useState(null); // {type, msg}\n\n//   const [query, setQuery] = useState(\"\");\n//   const [roleFilter, setRoleFilter] = useState(\"all\");\n\n//   const [form, setForm] = useState({\n//     name: \"\",\n//     email: \"\",\n//     phone: \"\",\n//     staffRole: \"\",\n//     experience: \"\",\n//     joiningDate: \"\",\n//   });\n\n//   const fetchStaff = async () => {\n//     setLoading(true);\n//     setStatus(null);\n//     try {\n//       const res = await API.get(\"/users/staff\");\n//       setStaffList(res.data?.data || []);\n//       console.log(res.data);\n//     } catch (e) {\n//       console.error(e);\n//       setStatus({ type: \"error\", msg: \"Failed to load staff list.\" });\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   useEffect(() => {\n//     fetchStaff();\n//   }, []);\n\n//   const stats = useMemo(() => {\n//     const total = staffList.length;\n//     const caregiver = staffList.filter(\n//       (s) => s.staffRole === \"caregiver\"\n//     ).length;\n//     const teacher = staffList.filter((s) => s.staffRole === \"teacher\").length;\n//     const cook = staffList.filter((s) => s.staffRole === \"cook\").length;\n//     return { total, caregiver, teacher, cook };\n//   }, [staffList]);\n\n//   const filtered = useMemo(() => {\n//     const q = query.trim().toLowerCase();\n//     return staffList\n//       .filter((s) => {\n//         if (roleFilter !== \"all\" && s.staffRole !== roleFilter) return false;\n//         if (!q) return true;\n//         const hay = `${s.name || \"\"} ${s.email || \"\"} ${\n//           s.phone || \"\"\n//         }`.toLowerCase();\n//         return hay.includes(q);\n//       })\n//       .slice()\n//       .sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\n//   }, [staffList, query, roleFilter]);\n\n//   const handleCreateStaff = async (e) => {\n//     e.preventDefault();\n//     setStatus(null);\n//     setCreating(true);\n\n//     try {\n//       const payload = {\n//         name: form.name.trim(),\n//         email: form.email.trim(),\n//         phone: form.phone.trim(),\n//         staffRole: form.staffRole,\n//         experience:\n//           form.experience === \"\" ? undefined : Number(form.experience),\n//         joiningDate: form.joiningDate || undefined,\n//       };\n//       console.log(payload);\n\n//       const res = await API.post(\"/users/staff\", payload);\n//       const created = res.data?.data;\n//       const tempPassword = res.data?.tempPassword;\n\n//       setStaffList((prev) => [created, ...prev].filter(Boolean));\n//       setForm({\n//         name: \"\",\n//         email: \"\",\n//         phone: \"\",\n//         staffRole: \"caregiver\",\n//         experience: \"\",\n//         joiningDate: \"\",\n//       });\n\n//       setStatus({\n//         type: \"success\",\n//         msg: tempPassword\n//           ? `Staff created. Temporary password: ${tempPassword} (share this with staff to log in).`\n//           : \"Staff created successfully.\",\n//       });\n//     } catch (err) {\n//       console.error(err);\n//       setStatus({\n//         type: \"error\",\n//         msg: err.response?.data?.error || \"Failed to create staff.\",\n//       });\n//     } finally {\n//       setCreating(false);\n//     }\n//   };\n\n//   const deleteStaff = async (id) => {\n//     if (!window.confirm(\"Remove this staff member?\")) return;\n//     try {\n//       await API.delete(`/users/${id}`);\n//       setStaffList((prev) => prev.filter((s) => s._id !== id));\n//     } catch (err) {\n//       console.error(err);\n//       setStatus({ type: \"error\", msg: \"Failed to delete staff.\" });\n//     }\n//   };\n\n//   // Handle Admin Request for User\n//   const handleAdminRequest = async (id) => {\n//     try {\n//       const res = await API.post(`/users/request-admin/${id}`);\n//       alert(res.data?.message || \"Admin request submitted successfully.\");\n//     } catch (err) {\n//       alert(\"Failed to submit admin request.\");\n//     }\n//   };\n\n//   return (\n//     <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50\">\n//       {/* Top bar */}\n//       <div className=\"sticky top-0 z-10 border-b bg-white/80 backdrop-blur\">\n//         <div className=\"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between\">\n//           <div>\n//             <h1 className=\"text-2xl font-bold text-slate-900\">Admin Portal</h1>\n//             <p className=\"text-sm text-slate-600\">\n//               Staff management • roles • onboarding\n//             </p>\n//           </div>\n\n//           <div className=\"flex items-center gap-3\">\n//             <div className=\"hidden sm:block text-right\">\n//               <div className=\"text-sm font-semibold text-slate-900\">\n//                 {user?.name || \"Admin\"}\n//               </div>\n//               <div className=\"text-xs text-slate-500\">{user?.email}</div>\n//             </div>\n//             <button\n//               onClick={logout}\n//               className=\"px-4 py-2 rounded-xl bg-slate-900 text-white hover:bg-slate-800 transition\"\n//             >\n//               Logout\n//             </button>\n//           </div>\n//         </div>\n//       </div>\n\n//       <div className=\"max-w-7xl mx-auto px-4 py-8\">\n//         {/* Status */}\n//         {status?.type && (\n//           <div\n//             className={`mb-6 rounded-2xl border px-4 py-3 text-sm shadow-sm ${\n//               status.type === \"success\"\n//                 ? \"bg-emerald-50 text-emerald-800 border-emerald-200\"\n//                 : \"bg-rose-50 text-rose-800 border-rose-200\"\n//             }`}\n//           >\n//             {status.msg}\n//           </div>\n//         )}\n\n//         {/* Stats */}\n//         <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n//           <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n//             <div className=\"text-xs text-slate-500\">Total Staff</div>\n//             <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n//               {stats.total}\n//             </div>\n//           </div>\n//           <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n//             <div className=\"text-xs text-slate-500\">Caregivers</div>\n//             <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n//               {stats.caregiver}\n//             </div>\n//           </div>\n//           <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n//             <div className=\"text-xs text-slate-500\">Teachers</div>\n//             <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n//               {stats.teacher}\n//             </div>\n//           </div>\n//           <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n//             <div className=\"text-xs text-slate-500\">Cooks</div>\n//             <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n//               {stats.cook}\n//             </div>\n//           </div>\n//         </div>\n\n//         <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n//           {/* Create staff */}\n//           <div className=\"lg:col-span-1\">\n//             <div className=\"rounded-2xl border bg-white shadow-sm overflow-hidden\">\n//               <div className=\"px-6 py-5 border-b flex items-center gap-3\">\n//                 <div className=\"p-2 rounded-xl bg-indigo-50 border border-indigo-100\">\n//                   <UserPlusIcon className=\"h-5 w-5 text-indigo-700\" />\n//                 </div>\n//                 <div>\n//                   <h2 className=\"font-semibold text-slate-900\">Add Staff</h2>\n//                   <p className=\"text-xs text-slate-500\">\n//                     Create a staff account with a sub-role\n//                   </p>\n//                 </div>\n//               </div>\n\n//               <form onSubmit={handleCreateStaff} className=\"p-6 space-y-4\">\n//                 <div>\n//                   <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                     Full Name\n//                   </label>\n//                   <input\n//                     value={form.name}\n//                     onChange={(e) => setForm({ ...form, name: e.target.value })}\n//                     required\n//                     className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     placeholder=\"e.g., Ayesha Rahman\"\n//                   />\n//                 </div>\n\n//                 <div>\n//                   <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                     Email\n//                   </label>\n//                   <input\n//                     type=\"email\"\n//                     value={form.email}\n//                     onChange={(e) =>\n//                       setForm({ ...form, email: e.target.value })\n//                     }\n//                     required\n//                     className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     placeholder=\"e.g., staff@daycare.com\"\n//                   />\n//                 </div>\n\n//                 <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n//                   <div>\n//                     <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                       Phone\n//                     </label>\n//                     <input\n//                       value={form.phone}\n//                       onChange={(e) =>\n//                         setForm({ ...form, phone: e.target.value })\n//                       }\n//                       className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                       placeholder=\"017XXXXXXXX\"\n//                     />\n//                   </div>\n\n//                   <div>\n//                     <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                       Staff Role\n//                     </label>\n//                     <select\n//                       value={form.staffRole}\n//                       onChange={(e) =>\n//                         setForm({ ...form, staffRole: e.target.value })\n//                       }\n//                       className=\"w-full rounded-xl border px-3 py-2.5 bg-white focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     >\n//                       {STAFF_ROLES.map((r) => (\n//                         <option key={r.value} value={r.value}>\n//                           {r.label}\n//                         </option>\n//                       ))}\n//                     </select>\n//                   </div>\n//                 </div>\n\n//                 <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n//                   <div>\n//                     <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                       Experience (years)\n//                     </label>\n//                     <input\n//                       type=\"number\"\n//                       min=\"0\"\n//                       value={form.experience}\n//                       onChange={(e) =>\n//                         setForm({ ...form, experience: e.target.value })\n//                       }\n//                       className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                       placeholder=\"e.g., 3\"\n//                     />\n//                   </div>\n\n//                   <div>\n//                     <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n//                       Joining Date\n//                     </label>\n//                     <input\n//                       type=\"date\"\n//                       value={form.joiningDate}\n//                       onChange={(e) =>\n//                         setForm({ ...form, joiningDate: e.target.value })\n//                       }\n//                       className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     />\n//                   </div>\n//                 </div>\n\n//                 <button\n//                   type=\"submit\"\n//                   disabled={creating}\n//                   className=\"w-full rounded-xl bg-indigo-600 text-white py-2.5 font-semibold hover:bg-indigo-700 disabled:opacity-60 transition\"\n//                 >\n//                   {creating ? \"Creating...\" : \"Create Staff\"}\n//                 </button>\n\n//                 <p className=\"text-xs text-slate-500\">\n//                   Tip: a temporary password is generated automatically. Share it\n//                   with the staff member so they can log in.\n//                 </p>\n//               </form>\n//             </div>\n//           </div>\n\n//           {/* Staff table */}\n//           <div className=\"lg:col-span-2\">\n//             <div className=\"rounded-2xl border bg-white shadow-sm overflow-hidden\">\n//               <div className=\"px-6 py-5 border-b flex flex-col sm:flex-row sm:items-center gap-4 sm:justify-between\">\n//                 <div>\n//                   <h2 className=\"font-semibold text-slate-900\">\n//                     Staff Directory\n//                   </h2>\n//                   <p className=\"text-xs text-slate-500\">\n//                     Search, filter, and manage staff accounts\n//                   </p>\n//                 </div>\n\n//                 <div className=\"flex items-center gap-3\">\n//                   <div className=\"relative\">\n//                     <MagnifyingGlassIcon className=\"h-5 w-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2\" />\n//                     <input\n//                       value={query}\n//                       onChange={(e) => setQuery(e.target.value)}\n//                       placeholder=\"Search name, email, phone\"\n//                       className=\"pl-10 pr-3 py-2.5 rounded-xl border w-72 max-w-full focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                     />\n//                   </div>\n\n//                   <select\n//                     value={roleFilter}\n//                     onChange={(e) => setRoleFilter(e.target.value)}\n//                     className=\"py-2.5 rounded-xl border bg-white px-3 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n//                   >\n//                     <option value=\"all\">All roles</option>\n//                     {STAFF_ROLES.map((r) => (\n//                       <option key={r.value} value={r.value}>\n//                         {r.label}\n//                       </option>\n//                     ))}\n//                   </select>\n\n//                   <button\n//                     onClick={fetchStaff}\n//                     className=\"inline-flex items-center gap-2 px-3 py-2.5 rounded-xl border hover:bg-slate-50 transition\"\n//                     title=\"Refresh\"\n//                   >\n//                     <ArrowPathIcon className=\"h-5 w-5\" />\n//                     <span className=\"hidden sm:inline\">Refresh</span>\n//                   </button>\n//                 </div>\n//               </div>\n\n//               {loading ? (\n//                 <div className=\"py-10 text-center text-slate-500\">\n//                   Loading staff…\n//                 </div>\n//               ) : filtered.length === 0 ? (\n//                 <div className=\"py-10 text-center text-slate-500\">\n//                   No staff found. Try changing your search/filter.\n//                 </div>\n//               ) : (\n//                 <div className=\"overflow-x-auto\">\n//                   <table className=\"min-w-full text-sm\">\n//                     <thead>\n//                       <tr className=\"text-left bg-slate-50 border-b\">\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Staff\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Role\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Contact\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Experience\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Joining\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Added\n//                         </th>\n//                         <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n//                           Actions\n//                         </th>\n//                       </tr>\n//                     </thead>\n\n//                     <tbody>\n//                       {filtered.map((s) => (\n//                         <tr\n//                           key={s._id}\n//                           className=\"border-b last:border-b-0 hover:bg-slate-50/60\"\n//                         >\n//                           <td className=\"py-3.5 px-4\">\n//                             <div className=\"font-semibold text-slate-900\">\n//                               {s.name}\n//                             </div>\n//                             <div className=\"text-xs text-slate-500\">\n//                               {s.email}\n//                             </div>\n//                           </td>\n//                           <td className=\"py-3.5 px-4\">\n//                             <span\n//                               className={`inline-flex items-center px-2.5 py-1 rounded-full border text-xs font-semibold ${roleBadge(\n//                                 s.staffRole\n//                               )}`}\n//                             >\n//                               {String(s.staffRole).toUpperCase()}\n//                             </span>\n//                           </td>\n//                           <td className=\"py-3.5 px-4 text-slate-700\">\n//                             {s.phone || \"-\"}\n//                           </td>\n//                           <td className=\"py-3.5 px-4 text-slate-700\">\n//                             {s.experience === 0 || s.experience\n//                               ? `${s.experience} yrs`\n//                               : \"-\"}\n//                           </td>\n//                           <td className=\"py-3.5 px-4 text-slate-700\">\n//                             {fmtDate(s.joiningDate)}\n//                           </td>\n//                           <td className=\"py-3.5 px-4 text-slate-700\">\n//                             {fmtDate(s.createdAt)}\n//                           </td>\n//                           <td className=\"py-3.5 px-4\">\n//                             {s.role === \"parent\" && (\n//                               <button\n//                                 onClick={() => handleAdminRequest(s._id)}\n//                                 className=\"inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition\"\n//                               >\n//                                 Request Admin\n//                               </button>\n//                             )}\n//                             <button\n//                               onClick={() => deleteStaff(s._id)}\n//                               className=\"inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-rose-600 text-white hover:bg-rose-700 transition\"\n//                               title=\"Delete\"\n//                             >\n//                               <TrashIcon className=\"h-4 w-4\" />\n//                               Delete\n//                             </button>\n//                           </td>\n//                         </tr>\n//                       ))}\n//                     </tbody>\n//                   </table>\n//                 </div>\n//               )}\n//             </div>\n//           </div>\n//         </div>\n//       </div>\n//     </div>\n//   );\n// }\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport {\n  ArrowPathIcon,\n  MagnifyingGlassIcon,\n  UserPlusIcon,\n  TrashIcon,\n} from \"@heroicons/react/24/outline\";\nimport API from \"../utils/api\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport '../styles.css';\n\nconst STAFF_ROLES = [\n  { value: \"caregiver\", label: \"Caregiver\" },\n  { value: \"teacher\", label: \"Teacher\" },\n  { value: \"cook\", label: \"Cook\" },\n];\n\nconst roleBadge = (staffRole) => {\n  const v = String(staffRole || \"\").toLowerCase();\n  if (v === \"teacher\") return \"bg-indigo-50 text-indigo-700 border-indigo-200\";\n  if (v === \"cook\") return \"bg-amber-50 text-amber-700 border-amber-200\";\n  return \"bg-emerald-50 text-emerald-700 border-emerald-200\"; // caregiver default\n};\n\nconst fmtDate = (d) => (d ? new Date(d).toLocaleDateString() : \"-\");\n\nexport default function AdminDashboard() {\n  const { user, logout } = React.useContext(AuthContext);\n\n  // Staff state\n  const [staffList, setStaffList] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [creating, setCreating] = useState(false);\n  const [status, setStatus] = useState(null); // {type, msg}\n  const [query, setQuery] = useState(\"\");\n  const [roleFilter, setRoleFilter] = useState(\"all\");\n\n  const [form, setForm] = useState({\n    name: \"\",\n    email: \"\",\n    phone: \"\",\n    staffRole: \"caregiver\",\n    experience: \"\",\n    joiningDate: \"\",\n  });\n\n  // Children state\n  const [children, setChildren] = useState([]);\n  const [childrenLoading, setChildrenLoading] = useState(true);\n  const [assigningId, setAssigningId] = useState(null); // childId while assigning\n\n  // Staff Activities state\n  const [staffActivities, setStaffActivities] = useState([]);\n  const [activitiesLoading, setActivitiesLoading] = useState(true);\n\n  // Fetch staff activities\n  const fetchStaffActivities = async () => {\n    setActivitiesLoading(true);\n    try {\n      const res = await API.get(\"/admin/staff-record\");\n      // Sort by latest first\n      const sorted = (res.data.data || []).sort(\n        (a, b) => new Date(b.createdAt) - new Date(a.createdAt)\n      );\n      setStaffActivities(sorted);\n    } catch (err) {\n      console.error(\"Failed to fetch staff activities:\", err);\n      setStatus({\n        type: \"error\",\n        msg: \"Failed to load staff activity records.\",\n      });\n      setStaffActivities([]);\n    } finally {\n      setActivitiesLoading(false);\n    }\n  };\n\n  // Fetch on mount (add to existing useEffect)\n\n  // Fetch staff\n  const fetchStaff = async () => {\n    setLoading(true);\n    setStatus(null);\n    try {\n      const res = await API.get(\"/users/staff\");\n      setStaffList(res.data?.data || []);\n    } catch (e) {\n      console.error(e);\n      setStatus({ type: \"error\", msg: \"Failed to load staff list.\" });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Fetch children\n  const fetchChildren = async () => {\n    setChildrenLoading(true);\n    try {\n      const res = await API.get(\"/admin/getallchildren\");\n      setChildren(res.data || []);\n    } catch (err) {\n      console.error(err);\n      setStatus({ type: \"error\", msg: \"Failed to load children.\" });\n    } finally {\n      setChildrenLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchStaff();\n    fetchChildren();\n    fetchStaffActivities();\n  }, []);\n\n  // Staff stats\n  const stats = useMemo(() => {\n    const total = staffList.length;\n    const caregiver = staffList.filter(\n      (s) => s.staffRole === \"caregiver\"\n    ).length;\n    const teacher = staffList.filter((s) => s.staffRole === \"teacher\").length;\n    const cook = staffList.filter((s) => s.staffRole === \"cook\").length;\n    return { total, caregiver, teacher, cook };\n  }, [staffList]);\n\n  // Filtered staff\n  const filtered = useMemo(() => {\n    const q = query.trim().toLowerCase();\n    return staffList\n      .filter((s) => {\n        if (roleFilter !== \"all\" && s.staffRole !== roleFilter) return false;\n        if (!q) return true;\n        const hay = `${s.name || \"\"} ${s.email || \"\"} ${\n          s.phone || \"\"\n        }`.toLowerCase();\n        return hay.includes(q);\n      })\n      .slice()\n      .sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\n  }, [staffList, query, roleFilter]);\n\n  // List of caregivers only (for dropdown)\n  const caregivers = useMemo(() => {\n    return staffList\n      .filter((s) => s.staffRole === \"caregiver\")\n      .sort((a, b) => a.name.localeCompare(b.name));\n  }, [staffList]);\n\n  // Create staff\n  const handleCreateStaff = async (e) => {\n    e.preventDefault();\n    setStatus(null);\n    setCreating(true);\n    try {\n      const payload = {\n        name: form.name.trim(),\n        email: form.email.trim(),\n        phone: form.phone.trim(),\n        staffRole: form.staffRole,\n        experience:\n          form.experience === \"\" ? undefined : Number(form.experience),\n        joiningDate: form.joiningDate || undefined,\n      };\n      const res = await API.post(\"/users/staff\", payload);\n      const created = res.data?.data;\n      const tempPassword = res.data?.tempPassword;\n\n      setStaffList((prev) => [created, ...prev].filter(Boolean));\n      setForm({\n        name: \"\",\n        email: \"\",\n        phone: \"\",\n        staffRole: \"caregiver\",\n        experience: \"\",\n        joiningDate: \"\",\n      });\n      setStatus({\n        type: \"success\",\n        msg: tempPassword\n          ? `Staff created. Temporary password: ${tempPassword}`\n          : \"Staff created successfully.\",\n      });\n    } catch (err) {\n      console.error(err);\n      setStatus({\n        type: \"error\",\n        msg: err.response?.data?.error || \"Failed to create staff.\",\n      });\n    } finally {\n      setCreating(false);\n    }\n  };\n\n  // Delete staff\n  const deleteStaff = async (id) => {\n    if (!window.confirm(\"Remove this staff member?\")) return;\n    try {\n      await API.delete(`/users/${id}`);\n      setStaffList((prev) => prev.filter((s) => s._id !== id));\n      setStatus({ type: \"success\", msg: \"Staff deleted.\" });\n    } catch (err) {\n      console.error(err);\n      setStatus({ type: \"error\", msg: \"Failed to delete staff.\" });\n    }\n  };\n\n  // Assign caregiver\n  const handleAssignCaregiver = async (childId, caregiverId) => {\n    // Allow empty string to unassign\n    setAssigningId(childId);\n    try {\n      await API.post(\"/admin/assign-caregiver\", {\n        childId,\n        caregiverId: caregiverId || null, // backend should handle null/empty as unassign if needed\n      });\n\n      setChildren((prev) =>\n        prev.map((c) =>\n          c._id === childId ? { ...c, caregiver: caregiverId || null } : c\n        )\n      );\n\n      setStatus({\n        type: \"success\",\n        msg: \"Caregiver assigned successfully!\",\n      });\n    } catch (err) {\n      console.error(err);\n      setStatus({\n        type: \"error\",\n        msg: err.response?.data?.error || \"Failed to assign caregiver.\",\n      });\n    } finally {\n      setAssigningId(null);\n    }\n  };\n\n  const handleUpdateCaregiver = async (childId, caregiverId) => {\n    setAssigningId(childId);\n    try {\n      await API.put(`/admin/assign-caregiver/${childId}`, {\n        caregiverId: caregiverId || null,\n      });\n\n      // Update local state\n      setChildren((prev) =>\n        prev.map((c) =>\n          c._id === childId ? { ...c, caregiver: caregiverId } : c\n        )\n      );\n\n      setStatus({\n        type: \"success\",\n        msg: caregiverId\n          ? \"Caregiver assigned successfully!\"\n          : \"Caregiver removed successfully!\",\n      });\n    } catch (err) {\n      console.error(err);\n      setStatus({\n        type: \"error\",\n        msg: err.response?.data?.error || \"Failed to update caregiver.\",\n      });\n    } finally {\n      setAssigningId(null);\n    }\n  };\n\n  // Helper to get caregiver name\n  const getCaregiverName = (caregiverId) => {\n    if (!caregiverId) return \"None\";\n    const cg = staffList.find((s) => s._id === caregiverId);\n    return cg ? cg.name : \"Unknown\";\n  };\n\n  return (\n    <div className=\"min-h-screen\" style={{ background: 'linear-gradient(135deg, #f5cfcf 0%, #dbbfbf 100%)' }}>\n      {/* Top bar */}\n      <div className=\"sticky top-0 z-10 border-b bg-white/80 backdrop-blur\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-slate-900\">Admin Portal</h1>\n            <p className=\"text-sm text-slate-600\">\n              Staff management • children • caregiver assignment\n            </p>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <div className=\"hidden sm:block text-right\">\n              <div className=\"text-sm font-semibold text-slate-900\">\n                {user?.name || \"Admin\"}\n              </div>\n              <div className=\"text-xs text-slate-500\">{user?.email}</div>\n            </div>\n            <button\n              onClick={logout}\n              className=\"px-4 py-2 rounded-xl bg-slate-900 text-white hover:bg-slate-800 transition\"\n            >\n              Logout\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\n        {/* Status Message */}\n        {status?.type && (\n          <div\n            className={`mb-6 rounded-2xl border px-4 py-3 text-sm shadow-sm ${\n              status.type === \"success\"\n                ? \"bg-emerald-50 text-emerald-800 border-emerald-200\"\n                : \"bg-rose-50 text-rose-800 border-rose-200\"\n            }`}\n          >\n            {status.msg}\n          </div>\n        )}\n\n        {/* Stats Cards */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n          <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n            <div className=\"text-xs text-slate-500\">Total Staff</div>\n            <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n              {stats.total}\n            </div>\n          </div>\n          <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n            <div className=\"text-xs text-slate-500\">Caregivers</div>\n            <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n              {stats.caregiver}\n            </div>\n          </div>\n          <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n            <div className=\"text-xs text-slate-500\">Teachers</div>\n            <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n              {stats.teacher}\n            </div>\n          </div>\n          <div className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n            <div className=\"text-xs text-slate-500\">Cooks</div>\n            <div className=\"mt-2 text-3xl font-bold text-slate-900\">\n              {stats.cook}\n            </div>\n          </div>\n        </div>\n\n        {/* Staff Management Section */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-12\">\n          {/* Add Staff Form */}\n          <div className=\"lg:col-span-1\">\n            <div className=\"rounded-2xl border bg-white shadow-sm overflow-hidden\">\n              <div className=\"px-6 py-5 border-b flex items-center gap-3\">\n                <div className=\"p-2 rounded-xl bg-indigo-50 border border-indigo-100\">\n                  <UserPlusIcon className=\"h-5 w-5 text-indigo-700\" />\n                </div>\n                <div>\n                  <h2 className=\"font-semibold text-slate-900\">Add Staff</h2>\n                  <p className=\"text-xs text-slate-500\">\n                    Create a staff account with a sub-role\n                  </p>\n                </div>\n              </div>\n              <form onSubmit={handleCreateStaff} className=\"p-6 space-y-4\">\n                <div>\n                  <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n                    Full Name\n                  </label>\n                  <input\n                    value={form.name}\n                    onChange={(e) => setForm({ ...form, name: e.target.value })}\n                    required\n                    className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n                    placeholder=\"e.g., Ayesha Rahman\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n                    Email\n                  </label>\n                  <input\n                    type=\"email\"\n                    value={form.email}\n                    onChange={(e) =>\n                      setForm({ ...form, email: e.target.value })\n                    }\n                    required\n                    className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n                    placeholder=\"e.g., staff@daycare.com\"\n                  />\n                </div>\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n                      Phone\n                    </label>\n                    <input\n                      value={form.phone}\n                      onChange={(e) =>\n                        setForm({ ...form, phone: e.target.value })\n                      }\n                      className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n                      placeholder=\"017XXXXXXXX\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n                      Staff Role\n                    </label>\n                    <select\n                      value={form.staffRole}\n                      onChange={(e) =>\n                        setForm({ ...form, staffRole: e.target.value })\n                      }\n                      className=\"w-full rounded-xl border px-3 py-2.5 bg-white focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n                    >\n                      {STAFF_ROLES.map((r) => (\n                        <option key={r.value} value={r.value}>\n                          {r.label}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n                      Experience (years)\n                    </label>\n                    <input\n                      type=\"number\"\n                      min=\"0\"\n                      value={form.experience}\n                      onChange={(e) =>\n                        setForm({ ...form, experience: e.target.value })\n                      }\n                      className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n                      placeholder=\"e.g., 3\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-xs font-semibold text-slate-700 mb-1\">\n                      Joining Date\n                    </label>\n                    <input\n                      type=\"date\"\n                      value={form.joiningDate}\n                      onChange={(e) =>\n                        setForm({ ...form, joiningDate: e.target.value })\n                      }\n                      className=\"w-full rounded-xl border px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n                    />\n                  </div>\n                </div>\n                <button\n                  type=\"submit\"\n                  disabled={creating}\n                  className=\"w-full rounded-xl bg-indigo-600 text-white py-2.5 font-semibold hover:bg-indigo-700 disabled:opacity-60 transition\"\n                >\n                  {creating ? \"Creating...\" : \"Create Staff\"}\n                </button>\n                <p className=\"text-xs text-slate-500\">\n                  A temporary password will be generated and shown after\n                  creation.\n                </p>\n              </form>\n            </div>\n          </div>\n\n          {/* Staff Directory Table */}\n          <div className=\"lg:col-span-2\">\n            <div className=\"rounded-2xl border bg-white shadow-sm overflow-hidden\">\n              <div className=\"px-6 py-5 border-b flex flex-col sm:flex-row sm:items-center gap-4 sm:justify-between\">\n                <div>\n                  <h2 className=\"font-semibold text-slate-900\">\n                    Staff Directory\n                  </h2>\n                  <p className=\"text-xs text-slate-500\">\n                    Search, filter, and manage staff accounts\n                  </p>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"relative\">\n                    <MagnifyingGlassIcon className=\"h-5 w-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2\" />\n                    <input\n                      value={query}\n                      onChange={(e) => setQuery(e.target.value)}\n                      placeholder=\"Search name, email, phone\"\n                      className=\"pl-10 pr-3 py-2.5 rounded-xl border w-72 max-w-full focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n                    />\n                  </div>\n                  <select\n                    value={roleFilter}\n                    onChange={(e) => setRoleFilter(e.target.value)}\n                    className=\"py-2.5 rounded-xl border bg-white px-3 focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n                  >\n                    <option value=\"all\">All roles</option>\n                    {STAFF_ROLES.map((r) => (\n                      <option key={r.value} value={r.value}>\n                        {r.label}\n                      </option>\n                    ))}\n                  </select>\n                  <button\n                    onClick={fetchStaff}\n                    className=\"inline-flex items-center gap-2 px-3 py-2.5 rounded-xl border hover:bg-slate-50 transition\"\n                    title=\"Refresh\"\n                  >\n                    <ArrowPathIcon className=\"h-5 w-5\" />\n                    <span className=\"hidden sm:inline\">Refresh</span>\n                  </button>\n                </div>\n              </div>\n\n              {loading ? (\n                <div className=\"py-10 text-center text-slate-500\">\n                  Loading staff…\n                </div>\n              ) : filtered.length === 0 ? (\n                <div className=\"py-10 text-center text-slate-500\">\n                  No staff found.\n                </div>\n              ) : (\n                <div className=\"overflow-x-auto\">\n                  <table className=\"min-w-full text-sm\">\n                    <thead>\n                      <tr className=\"text-left bg-slate-50 border-b\">\n                        <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                          Staff\n                        </th>\n                        <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                          Role\n                        </th>\n                        <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                          Contact\n                        </th>\n                        <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                          Experience\n                        </th>\n                        <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                          Joining\n                        </th>\n                        <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                          Added\n                        </th>\n                        <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                          Actions\n                        </th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {filtered.map((s) => (\n                        <tr\n                          key={s._id}\n                          className=\"border-b last:border-b-0 hover:bg-slate-50/60\"\n                        >\n                          <td className=\"py-3.5 px-4\">\n                            <div className=\"font-semibold text-slate-900\">\n                              {s.name}\n                            </div>\n                            <div className=\"text-xs text-slate-500\">\n                              {s.email}\n                            </div>\n                          </td>\n                          <td className=\"py-3.5 px-4\">\n                            <span\n                              className={`inline-flex items-center px-2.5 py-1 rounded-full border text-xs font-semibold ${roleBadge(\n                                s.staffRole\n                              )}`}\n                            >\n                              {String(s.staffRole).toUpperCase()}\n                            </span>\n                          </td>\n                          <td className=\"py-3.5 px-4 text-slate-700\">\n                            {s.phone || \"-\"}\n                          </td>\n                          <td className=\"py-3.5 px-4 text-slate-700\">\n                            {s.experience !== undefined\n                              ? `${s.experience} yrs`\n                              : \"-\"}\n                          </td>\n                          <td className=\"py-3.5 px-4 text-slate-700\">\n                            {fmtDate(s.joiningDate)}\n                          </td>\n                          <td className=\"py-3.5 px-4 text-slate-700\">\n                            {fmtDate(s.createdAt)}\n                          </td>\n                          <td className=\"py-3.5 px-4\">\n                            <button\n                              onClick={() => deleteStaff(s._id)}\n                              className=\"inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-rose-600 text-white hover:bg-rose-700 transition text-sm\"\n                            >\n                              <TrashIcon className=\"h-4 w-4\" />\n                              Delete\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Children & Caregiver Assignment Section */}\n        {/* Children & Caregiver Assignment Section - Updated */}\n        <div className=\"rounded-2xl border bg-white shadow-sm overflow-hidden\">\n          <div className=\"px-6 py-5 border-b flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 rounded-xl bg-emerald-50 border border-emerald-100\">\n                <UserPlusIcon className=\"h-5 w-5 text-emerald-700\" />\n              </div>\n              <div>\n                <h2 className=\"font-semibold text-slate-900\">\n                  Children & Caregiver Management\n                </h2>\n                <p className=\"text-xs text-slate-500\">\n                  Assign, update, or remove caregivers for each child\n                </p>\n              </div>\n            </div>\n            <button\n              onClick={fetchChildren}\n              className=\"inline-flex items-center gap-2 px-3 py-2.5 rounded-xl border hover:bg-slate-50 transition\"\n            >\n              <ArrowPathIcon className=\"h-5 w-5\" />\n              <span className=\"hidden sm:inline\">Refresh</span>\n            </button>\n          </div>\n\n          {childrenLoading ? (\n            <div className=\"py-10 text-center text-slate-500\">\n              Loading children…\n            </div>\n          ) : children.length === 0 ? (\n            <div className=\"py-10 text-center text-slate-500\">\n              No children registered yet.\n            </div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <table className=\"min-w-full text-sm\">\n                <thead>\n                  <tr className=\"text-left bg-slate-50 border-b\">\n                    <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                      Child\n                    </th>\n                    <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                      Date of Birth\n                    </th>\n                    <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                      Parent\n                    </th>\n                    <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                      Current Caregiver\n                    </th>\n                    <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                      Actions\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {children.map((child) => (\n                    <tr\n                      key={child._id}\n                      className=\"border-b last:border-b-0 hover:bg-slate-50/60\"\n                    >\n                      <td className=\"py-3.5 px-4\">\n                        <div className=\"font-semibold text-slate-900\">\n                          {child.name}\n                        </div>\n                        <div className=\"text-xs text-slate-500\">\n                          ID: {child._id}\n                        </div>\n                      </td>\n                      <td className=\"py-3.5 px-4 text-slate-700\">\n                        {child.dateOfBirth\n                          ? new Date(child.dateOfBirth).toLocaleDateString()\n                          : \"-\"}\n                      </td>\n                      <td className=\"py-3.5 px-4 text-slate-700\">\n                        {child.parent?.name || \"-\"}\n                      </td>\n                      <td className=\"py-3.5 px-4\">\n                        <span\n                          className={`inline-flex items-center px-2.5 py-1 rounded-full border text-xs font-semibold ${\n                            child.caregiver\n                              ? \"bg-emerald-50 text-emerald-700 border-emerald-200\"\n                              : \"bg-gray-100 text-gray-600 border-gray-300\"\n                          }`}\n                        >\n                          {getCaregiverName(child.caregiver)}\n                        </span>\n                      </td>\n                      <td className=\"py-3.5 px-4\">\n                        <div className=\"flex items-center gap-3\">\n                          {/* Assign / Update Caregiver Dropdown */}\n                          <select\n                            value={child.caregiver || \"\"}\n                            disabled={assigningId === child._id}\n                            onChange={(e) => {\n                              const newCaregiverId = e.target.value || null;\n                              handleUpdateCaregiver(child._id, newCaregiverId);\n                            }}\n                            className=\"rounded-xl border px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-indigo-200\"\n                          >\n                            <option value=\"\">— No caregiver —</option>\n                            {caregivers.map((cg) => (\n                              <option key={cg._id} value={cg._id}>\n                                {cg.name} ({cg.email})\n                              </option>\n                            ))}\n                          </select>\n\n                          {/* Explicit Remove Button */}\n                          {child.caregiver && (\n                            <button\n                              onClick={() =>\n                                handleUpdateCaregiver(child._id, null)\n                              }\n                              disabled={assigningId === child._id}\n                              className=\"px-3 py-2 rounded-xl bg-rose-600 text-white text-sm hover:bg-rose-700 disabled:opacity-60 transition flex items-center gap-1.5\"\n                            >\n                              <TrashIcon className=\"h-4 w-4\" />\n                              Remove\n                            </button>\n                          )}\n\n                          {assigningId === child._id && (\n                            <span className=\"text-xs text-slate-500\">\n                              saving…\n                            </span>\n                          )}\n                        </div>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </div>\n\n        {/* ==================== STAFF ACTIVITY RECORDS SECTION ==================== */}\n        <div className=\"rounded-2xl border bg-white shadow-sm overflow-hidden\">\n          <div className=\"px-6 py-5 border-b flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 rounded-xl bg-amber-50 border border-amber-100\">\n                <ArrowPathIcon className=\"h-5 w-5 text-amber-700\" />\n              </div>\n              <div>\n                <h2 className=\"font-semibold text-slate-900\">\n                  Staff Activity Log\n                </h2>\n                <p className=\"text-xs text-slate-500\">\n                  All recorded activities from caregivers, teachers, and cooks\n                </p>\n              </div>\n            </div>\n            <button\n              onClick={fetchStaffActivities}\n              disabled={activitiesLoading}\n              className=\"inline-flex items-center gap-2 px-3 py-2.5 rounded-xl border hover:bg-slate-50 transition disabled:opacity-60\"\n            >\n              <ArrowPathIcon\n                className={`h-5 w-5 ${activitiesLoading ? \"animate-spin\" : \"\"}`}\n              />\n              <span className=\"hidden sm:inline\">Refresh</span>\n            </button>\n          </div>\n\n          {activitiesLoading ? (\n            <div className=\"py-10 text-center text-slate-500\">\n              Loading activities…\n            </div>\n          ) : staffActivities.length === 0 ? (\n            <div className=\"py-10 text-center text-slate-500\">\n              No staff activities recorded yet.\n            </div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <table className=\"min-w-full text-sm\">\n                <thead>\n                  <tr className=\"text-left bg-slate-50 border-b\">\n                    <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                      Staff Member\n                    </th>\n                    <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                      Role\n                    </th>\n                    <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                      Activity\n                    </th>\n                    <th className=\"py-3.5 px-4 font-semibold text-slate-700\">\n                      Timestamp\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {staffActivities.map((activity) => {\n                    const staff = staffList.find(\n                      (s) => s._id === activity.staffId\n                    );\n                    return (\n                      <tr\n                        key={activity._id}\n                        className=\"border-b last:border-b-0 hover:bg-slate-50/60\"\n                      >\n                        <td className=\"py-3.5 px-4\">\n                          <div className=\"font-medium text-slate-900\">\n                            {staff?.name || \"Unknown Staff\"}\n                          </div>\n                          <div className=\"text-xs text-slate-500\">\n                            {staff?.email || \"-\"}\n                          </div>\n                        </td>\n                        <td className=\"py-3.5 px-4\">\n                          <span\n                            className={`inline-flex items-center px-2.5 py-1 rounded-full border text-xs font-semibold ${roleBadge(\n                              staff?.staffRole\n                            )}`}\n                          >\n                            {staff?.staffRole?.toUpperCase() || \"N/A\"}\n                          </span>\n                        </td>\n                        <td className=\"py-3.5 px-4 text-slate-700 font-medium\">\n                          {activity.activityname}\n                        </td>\n                        <td className=\"py-3.5 px-4 text-slate-700\">\n                          {new Date(activity.createdAt).toLocaleString()}\n                        </td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"iJAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAO,CAAAA,KAAK,EAAIC,SA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}