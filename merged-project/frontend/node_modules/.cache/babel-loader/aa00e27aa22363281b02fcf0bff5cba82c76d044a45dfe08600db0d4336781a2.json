{"ast":null,"code":"import{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{useContext}from'react';import{AuthContext}from'../context/AuthContext';import api from'../utils/billingApi';import'../styles.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BillingDashboard=()=>{const{user,logout}=useContext(AuthContext);const navigate=useNavigate();const[invoices,setInvoices]=useState([]);const[analytics,setAnalytics]=useState(null);const[loading,setLoading]=useState(false);const[genLoading,setGenLoading]=useState(false);const[error,setError]=useState('');const[success,setSuccess]=useState('');// Filter states\nconst[filterStatus,setFilterStatus]=useState('all');const[filterYear,setFilterYear]=useState(new Date().getFullYear());const[filterMonth,setFilterMonth]=useState(new Date().getMonth()+1);useEffect(()=>{if(user&&user.role!=='admin'){navigate('/admin');}},[user,navigate]);const fetchInvoices=async()=>{try{const params={};if(filterStatus!=='all')params.status=filterStatus;if(filterYear)params.year=filterYear;if(filterMonth)params.month=filterMonth;const res=await api.get('/billing/invoices',{params});setInvoices(res.data);setError('');}catch(err){var _err$response;console.error('Error fetching invoices:',err);if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401){logout();}else{setError('Failed to load invoices. Please check if the backend is running.');}}};const fetchAnalytics=async()=>{try{const res=await api.get('/analytics/summary');setAnalytics(res.data);setError('');}catch(err){var _err$response2;console.error('Error fetching analytics:',err);if(((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===401){logout();}else{setError('Failed to load analytics. Please check if the backend is running.');}}};const loadAll=async()=>{setLoading(true);setError('');await Promise.all([fetchInvoices(),fetchAnalytics()]);setLoading(false);};useEffect(()=>{if(user&&user.role==='admin'){loadAll();}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[filterStatus,filterYear,filterMonth]);const handleGenerateInvoices=async()=>{try{setGenLoading(true);setError('');setSuccess('');const now=new Date();const year=now.getFullYear();const month=now.getMonth()+1;await api.post(\"/billing/generate/\".concat(year,\"/\").concat(month));setSuccess(\"Invoices generated successfully for \".concat(month,\"/\").concat(year,\"!\"));await fetchInvoices();await fetchAnalytics();setTimeout(()=>setSuccess(''),5000);}catch(err){var _err$response3,_err$response3$data;console.error('Error generating invoices:',err);setError(((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.message)||'Failed to generate invoices.');}finally{setGenLoading(false);}};const handleMarkPaid=async id=>{try{setError('');await api.patch(\"/billing/invoices/\".concat(id,\"/pay\"));setSuccess('Invoice marked as paid successfully!');await fetchInvoices();await fetchAnalytics();setTimeout(()=>setSuccess(''),3000);}catch(err){var _err$response4,_err$response4$data;console.error('Error updating payment:',err);setError(((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.message)||'Failed to update payment status.');}};const handleViewInvoice=invoiceId=>{// Could open a modal or navigate to invoice detail page\nwindow.open(\"/api/billing/invoices/\".concat(invoiceId),'_blank');};// Calculate analytics\nconst avgPerInvoice=analytics&&analytics.revenue.invoiceCount>0?analytics.revenue.totalRevenueThisMonth/analytics.revenue.invoiceCount:0;const avgPerChild=analytics&&analytics.totalChildren>0?analytics.revenue.totalRevenueThisMonth/analytics.totalChildren:0;const avgChildrenPerStaff=analytics&&analytics.staffWorkload&&analytics.staffWorkload.length>0?(analytics.staffWorkload.reduce((sum,s)=>sum+(s.childrenAssignedCount||0),0)/analytics.staffWorkload.length).toFixed(1):0;// Generate year options (current year and past 2 years)\nconst currentYear=new Date().getFullYear();const yearOptions=Array.from({length:3},(_,i)=>currentYear-i);if(!user||user.role!=='admin'){return/*#__PURE__*/_jsx(\"div\",{className:\"app-container\",style:{padding:'40px 20px'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(\"p\",{children:\"Access denied. Admin access required.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>navigate('/admin'),children:\"Go to Admin Dashboard\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",style:{background:'linear-gradient(135deg, #f5cfcf 0%, #dbbfbf 100%)',minHeight:'100vh',padding:'20px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"header\",children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',flexWrap:'wrap',gap:'15px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"gwendolyn-bold\",children:\"\\uD83D\\uDCB0 Billing & Analytics Dashboard\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Manage invoices and view comprehensive analytics\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>navigate('/admin'),children:\"\\u2190 Back to Admin Dashboard\"})]})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",style:{marginBottom:'20px'},children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"success-message\",style:{marginBottom:'20px'},children:success}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",style:{marginBottom:'30px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',flexWrap:'wrap',gap:'15px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0},children:\"Quick Actions\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleGenerateInvoices,className:\"btn btn-primary\",disabled:genLoading||loading,children:genLoading?'Generating...':'üìÑ Generate Invoices for Current Month'})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'15px',flexWrap:'wrap',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'5px',fontWeight:'600'},children:\"Status:\"}),/*#__PURE__*/_jsxs(\"select\",{value:filterStatus,onChange:e=>setFilterStatus(e.target.value),className:\"form-control\",style:{width:'auto',minWidth:'150px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All Status\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paid\",children:\"Paid\"}),/*#__PURE__*/_jsx(\"option\",{value:\"unpaid\",children:\"Unpaid\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'5px',fontWeight:'600'},children:\"Year:\"}),/*#__PURE__*/_jsx(\"select\",{value:filterYear,onChange:e=>setFilterYear(parseInt(e.target.value)),className:\"form-control\",style:{width:'auto',minWidth:'120px'},children:yearOptions.map(year=>/*#__PURE__*/_jsx(\"option\",{value:year,children:year},year))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'5px',fontWeight:'600'},children:\"Month:\"}),/*#__PURE__*/_jsxs(\"select\",{value:filterMonth,onChange:e=>setFilterMonth(parseInt(e.target.value)),className:\"form-control\",style:{width:'auto',minWidth:'150px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"January\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"February\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"March\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"April\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"May\"}),/*#__PURE__*/_jsx(\"option\",{value:\"6\",children:\"June\"}),/*#__PURE__*/_jsx(\"option\",{value:\"7\",children:\"July\"}),/*#__PURE__*/_jsx(\"option\",{value:\"8\",children:\"August\"}),/*#__PURE__*/_jsx(\"option\",{value:\"9\",children:\"September\"}),/*#__PURE__*/_jsx(\"option\",{value:\"10\",children:\"October\"}),/*#__PURE__*/_jsx(\"option\",{value:\"11\",children:\"November\"}),/*#__PURE__*/_jsx(\"option\",{value:\"12\",children:\"December\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{alignSelf:'flex-end'},children:/*#__PURE__*/_jsx(\"button\",{onClick:loadAll,className:\"btn btn-primary\",disabled:loading,children:loading?'Loading...':'üîÑ Refresh'})})]})]}),analytics&&/*#__PURE__*/_jsxs(\"div\",{className:\"summary-grid\",style:{marginBottom:'30px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"summary-item\",style:{background:'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',color:'white',textAlign:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"summary-value\",style:{fontSize:'2.5rem',color:'white'},children:[\"\\u09F3 \",analytics.revenue.totalRevenueThisMonth.toFixed(0)]}),/*#__PURE__*/_jsx(\"div\",{className:\"summary-label\",style:{color:'rgba(255,255,255,0.9)'},children:\"Revenue (This Month)\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'15px',fontSize:'0.9rem',opacity:0.9},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Invoices: \",analytics.revenue.invoiceCount]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Paid: \",analytics.revenue.paidCount,\" | Unpaid: \",analytics.revenue.unpaidCount]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px',paddingTop:'10px',borderTop:'1px solid rgba(255,255,255,0.3)'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Avg per invoice: \\u09F3 \",avgPerInvoice.toFixed(0)]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Avg per child: \\u09F3 \",avgPerChild.toFixed(0)]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-item\",style:{background:'linear-gradient(135deg, #10b981 0%, #059669 100%)',color:'white',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"summary-value\",style:{fontSize:'2.5rem',color:'white'},children:analytics.totalChildren}),/*#__PURE__*/_jsx(\"div\",{className:\"summary-label\",style:{color:'rgba(255,255,255,0.9)'},children:\"Total Children\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'15px',fontSize:'0.9rem',opacity:0.9},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Avg attendance/week: \",analytics.averageAttendancePerWeek.toFixed(1)]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Busiest hour: \",analytics.busiestHour!==null?\"\".concat(analytics.busiestHour,\":00\"):'N/A']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-item\",style:{background:'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)',color:'white',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"summary-value\",style:{fontSize:'2.5rem',color:'white'},children:analytics.totalStaff}),/*#__PURE__*/_jsx(\"div\",{className:\"summary-label\",style:{color:'rgba(255,255,255,0.9)'},children:\"Total Staff\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'15px',fontSize:'0.9rem',opacity:0.9},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Avg children per staff: \",avgChildrenPerStaff]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px',paddingTop:'10px',borderTop:'1px solid rgba(255,255,255,0.3)'},children:[\"Meals: \",analytics.mealConsumptionStats.map(m=>\"\".concat(m.meal,\": \").concat(m.count)).join(', ')||'N/A']})]})]})]}),analytics&&analytics.occupancy&&analytics.occupancy.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",style:{marginBottom:'30px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'20px'},children:\"\\uD83D\\uDCC5 Daily Occupancy (Current Month)\"}),/*#__PURE__*/_jsx(\"div\",{style:{overflowX:'auto'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{background:'#c89b9b',color:'#2d3748'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Present\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Occupancy Rate\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:analytics.occupancy.map(row=>/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid #e2e8f0'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:row.date}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:row.present}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:[(row.occupancyRate*100).toFixed(1),\"%\"]})]},row.date))})]})})]}),analytics&&analytics.staffWorkload&&analytics.staffWorkload.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",style:{marginBottom:'30px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'20px'},children:\"\\uD83D\\uDC65 Staff Workload\"}),/*#__PURE__*/_jsx(\"div\",{style:{overflowX:'auto'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{background:'#c89b9b',color:'#2d3748'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Children Assigned\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Weekly Hours\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:analytics.staffWorkload.map((s,idx)=>/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid #e2e8f0'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:s.name}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0',textTransform:'capitalize'},children:s.role}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:s.childrenAssignedCount}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:s.weeklyHours})]},idx))})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'20px'},children:\"\\uD83D\\uDCCB Invoices\"}),loading?/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px'},children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading invoices...\"})}):invoices.length===0?/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'40px',color:'#666'},children:[/*#__PURE__*/_jsx(\"p\",{children:\"No invoices found for the selected filters.\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'0.9rem',marginTop:'10px'},children:\"Click \\\"Generate Invoices for Current Month\\\" to create invoices.\"})]}):/*#__PURE__*/_jsx(\"div\",{style:{overflowX:'auto'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{background:'#c89b9b',color:'#2d3748'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Child\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Month/Year\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Days\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Base/Day\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Extra\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'12px',textAlign:'left',border:'1px solid #a18a8a'},children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:invoices.map(inv=>{var _inv$child;return/*#__PURE__*/_jsxs(\"tr\",{style:{borderBottom:'1px solid #e2e8f0'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:((_inv$child=inv.child)===null||_inv$child===void 0?void 0:_inv$child.name)||'Unknown'}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:[inv.month,\"/\",inv.year]}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:inv.daysPresent}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:[\"\\u09F3 \",inv.baseRatePerDay]}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:[\"\\u09F3 \",inv.extraCharges]}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0',fontWeight:'600'},children:[\"\\u09F3 \",inv.totalAmount]}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:/*#__PURE__*/_jsx(\"span\",{style:{padding:'4px 12px',borderRadius:'20px',fontSize:'0.85rem',fontWeight:'600',background:inv.status==='paid'?'#d1fae5':'#fef3c7',color:inv.status==='paid'?'#065f46':'#92400e'},children:inv.status.toUpperCase()})}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'10px',border:'1px solid #e2e8f0'},children:[inv.status==='unpaid'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleMarkPaid(inv._id),className:\"btn btn-primary\",style:{padding:'6px 15px',fontSize:'0.9rem'},children:\"Mark Paid\"}),inv.status==='paid'&&/*#__PURE__*/_jsx(\"span\",{style:{color:'#10b981',fontSize:'0.9rem'},children:\"\\u2713 Paid\"})]})]},inv._id);})})]})})]})]});};export default BillingDashboard;","map":{"version":3,"names":["useEffect","useState","useNavigate","useContext","AuthContext","api","jsx","_jsx","jsxs","_jsxs","BillingDashboard","user","logout","navigate","invoices","setInvoices","analytics","setAnalytics","loading","setLoading","genLoading","setGenLoading","error","setError","success","setSuccess","filterStatus","setFilterStatus","filterYear","setFilterYear","Date","getFullYear","filterMonth","setFilterMonth","getMonth","role","fetchInvoices","params","status","year","month","res","get","data","err","_err$response","console","response","fetchAnalytics","_err$response2","loadAll","Promise","all","handleGenerateInvoices","now","post","concat","setTimeout","_err$response3","_err$response3$data","message","handleMarkPaid","id","patch","_err$response4","_err$response4$data","handleViewInvoice","invoiceId","window","open","avgPerInvoice","revenue","invoiceCount","totalRevenueThisMonth","avgPerChild","totalChildren","avgChildrenPerStaff","staffWorkload","length","reduce","sum","s","childrenAssignedCount","toFixed","currentYear","yearOptions","Array","from","_","i","className","style","padding","children","textAlign","onClick","background","minHeight","display","justifyContent","alignItems","flexWrap","gap","marginBottom","margin","disabled","fontWeight","value","onChange","e","target","width","minWidth","parseInt","map","alignSelf","color","fontSize","marginTop","opacity","paidCount","unpaidCount","paddingTop","borderTop","averageAttendancePerWeek","busiestHour","totalStaff","mealConsumptionStats","m","meal","count","join","occupancy","overflowX","borderCollapse","border","row","borderBottom","date","present","occupancyRate","idx","name","textTransform","weeklyHours","inv","_inv$child","child","daysPresent","baseRatePerDay","extraCharges","totalAmount","borderRadius","toUpperCase","_id"],"sources":["/media/dh77b/New Volume/smartdaycare/merged-project/frontend/src/pages/BillingDashboard.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useContext } from 'react';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport api from '../utils/billingApi';\r\nimport '../styles.css';\r\n\r\nconst BillingDashboard = () => {\r\n  const { user, logout } = useContext(AuthContext);\r\n  const navigate = useNavigate();\r\n  const [invoices, setInvoices] = useState([]);\r\n  const [analytics, setAnalytics] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [genLoading, setGenLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n  \r\n  // Filter states\r\n  const [filterStatus, setFilterStatus] = useState('all');\r\n  const [filterYear, setFilterYear] = useState(new Date().getFullYear());\r\n  const [filterMonth, setFilterMonth] = useState(new Date().getMonth() + 1);\r\n\r\n  useEffect(() => {\r\n    if (user && user.role !== 'admin') {\r\n      navigate('/admin');\r\n    }\r\n  }, [user, navigate]);\r\n\r\n  const fetchInvoices = async () => {\r\n    try {\r\n      const params = {};\r\n      if (filterStatus !== 'all') params.status = filterStatus;\r\n      if (filterYear) params.year = filterYear;\r\n      if (filterMonth) params.month = filterMonth;\r\n      \r\n      const res = await api.get('/billing/invoices', { params });\r\n      setInvoices(res.data);\r\n      setError('');\r\n    } catch (err) {\r\n      console.error('Error fetching invoices:', err);\r\n      if (err.response?.status === 401) {\r\n        logout();\r\n      } else {\r\n        setError('Failed to load invoices. Please check if the backend is running.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const fetchAnalytics = async () => {\r\n    try {\r\n      const res = await api.get('/analytics/summary');\r\n      setAnalytics(res.data);\r\n      setError('');\r\n    } catch (err) {\r\n      console.error('Error fetching analytics:', err);\r\n      if (err.response?.status === 401) {\r\n        logout();\r\n      } else {\r\n        setError('Failed to load analytics. Please check if the backend is running.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const loadAll = async () => {\r\n    setLoading(true);\r\n    setError('');\r\n    await Promise.all([fetchInvoices(), fetchAnalytics()]);\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user && user.role === 'admin') {\r\n      loadAll();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [filterStatus, filterYear, filterMonth]);\r\n\r\n  const handleGenerateInvoices = async () => {\r\n    try {\r\n      setGenLoading(true);\r\n      setError('');\r\n      setSuccess('');\r\n      const now = new Date();\r\n      const year = now.getFullYear();\r\n      const month = now.getMonth() + 1;\r\n      await api.post(`/billing/generate/${year}/${month}`);\r\n      setSuccess(`Invoices generated successfully for ${month}/${year}!`);\r\n      await fetchInvoices();\r\n      await fetchAnalytics();\r\n      setTimeout(() => setSuccess(''), 5000);\r\n    } catch (err) {\r\n      console.error('Error generating invoices:', err);\r\n      setError(err.response?.data?.message || 'Failed to generate invoices.');\r\n    } finally {\r\n      setGenLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleMarkPaid = async (id) => {\r\n    try {\r\n      setError('');\r\n      await api.patch(`/billing/invoices/${id}/pay`);\r\n      setSuccess('Invoice marked as paid successfully!');\r\n      await fetchInvoices();\r\n      await fetchAnalytics();\r\n      setTimeout(() => setSuccess(''), 3000);\r\n    } catch (err) {\r\n      console.error('Error updating payment:', err);\r\n      setError(err.response?.data?.message || 'Failed to update payment status.');\r\n    }\r\n  };\r\n\r\n  const handleViewInvoice = (invoiceId) => {\r\n    // Could open a modal or navigate to invoice detail page\r\n    window.open(`/api/billing/invoices/${invoiceId}`, '_blank');\r\n  };\r\n\r\n  // Calculate analytics\r\n  const avgPerInvoice =\r\n    analytics && analytics.revenue.invoiceCount > 0\r\n      ? analytics.revenue.totalRevenueThisMonth / analytics.revenue.invoiceCount\r\n      : 0;\r\n\r\n  const avgPerChild =\r\n    analytics && analytics.totalChildren > 0\r\n      ? analytics.revenue.totalRevenueThisMonth / analytics.totalChildren\r\n      : 0;\r\n\r\n  const avgChildrenPerStaff =\r\n    analytics && analytics.staffWorkload && analytics.staffWorkload.length > 0\r\n      ? (\r\n          analytics.staffWorkload.reduce(\r\n            (sum, s) => sum + (s.childrenAssignedCount || 0),\r\n            0\r\n          ) / analytics.staffWorkload.length\r\n        ).toFixed(1)\r\n      : 0;\r\n\r\n  // Generate year options (current year and past 2 years)\r\n  const currentYear = new Date().getFullYear();\r\n  const yearOptions = Array.from({ length: 3 }, (_, i) => currentYear - i);\r\n\r\n  if (!user || user.role !== 'admin') {\r\n    return (\r\n      <div className=\"app-container\" style={{ padding: '40px 20px' }}>\r\n        <div className=\"form-container\" style={{ textAlign: 'center' }}>\r\n          <p>Access denied. Admin access required.</p>\r\n          <button className=\"btn btn-primary\" onClick={() => navigate('/admin')}>\r\n            Go to Admin Dashboard\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"app-container\" style={{ background: 'linear-gradient(135deg, #f5cfcf 0%, #dbbfbf 100%)', minHeight: '100vh', padding: '20px' }}>\r\n      {/* Header */}\r\n      <div className=\"header\">\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '15px' }}>\r\n          <div>\r\n            <h1 className=\"gwendolyn-bold\">üí∞ Billing & Analytics Dashboard</h1>\r\n            <p>Manage invoices and view comprehensive analytics</p>\r\n          </div>\r\n          <button className=\"btn btn-primary\" onClick={() => navigate('/admin')}>\r\n            ‚Üê Back to Admin Dashboard\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Status Messages */}\r\n      {error && (\r\n        <div className=\"error-message\" style={{ marginBottom: '20px' }}>\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {success && (\r\n        <div className=\"success-message\" style={{ marginBottom: '20px' }}>\r\n          {success}\r\n        </div>\r\n      )}\r\n\r\n      {/* Action Bar */}\r\n      <div className=\"form-container\" style={{ marginBottom: '30px' }}>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '15px', marginBottom: '20px' }}>\r\n          <h2 style={{ margin: 0 }}>Quick Actions</h2>\r\n          <button\r\n            onClick={handleGenerateInvoices}\r\n            className=\"btn btn-primary\"\r\n            disabled={genLoading || loading}\r\n          >\r\n            {genLoading ? 'Generating...' : 'üìÑ Generate Invoices for Current Month'}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <div style={{ display: 'flex', gap: '15px', flexWrap: 'wrap', alignItems: 'center' }}>\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: '600' }}>Status:</label>\r\n            <select\r\n              value={filterStatus}\r\n              onChange={(e) => setFilterStatus(e.target.value)}\r\n              className=\"form-control\"\r\n              style={{ width: 'auto', minWidth: '150px' }}\r\n            >\r\n              <option value=\"all\">All Status</option>\r\n              <option value=\"paid\">Paid</option>\r\n              <option value=\"unpaid\">Unpaid</option>\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: '600' }}>Year:</label>\r\n            <select\r\n              value={filterYear}\r\n              onChange={(e) => setFilterYear(parseInt(e.target.value))}\r\n              className=\"form-control\"\r\n              style={{ width: 'auto', minWidth: '120px' }}\r\n            >\r\n              {yearOptions.map(year => (\r\n                <option key={year} value={year}>{year}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: '600' }}>Month:</label>\r\n            <select\r\n              value={filterMonth}\r\n              onChange={(e) => setFilterMonth(parseInt(e.target.value))}\r\n              className=\"form-control\"\r\n              style={{ width: 'auto', minWidth: '150px' }}\r\n            >\r\n              <option value=\"1\">January</option>\r\n              <option value=\"2\">February</option>\r\n              <option value=\"3\">March</option>\r\n              <option value=\"4\">April</option>\r\n              <option value=\"5\">May</option>\r\n              <option value=\"6\">June</option>\r\n              <option value=\"7\">July</option>\r\n              <option value=\"8\">August</option>\r\n              <option value=\"9\">September</option>\r\n              <option value=\"10\">October</option>\r\n              <option value=\"11\">November</option>\r\n              <option value=\"12\">December</option>\r\n            </select>\r\n          </div>\r\n          <div style={{ alignSelf: 'flex-end' }}>\r\n            <button\r\n              onClick={loadAll}\r\n              className=\"btn btn-primary\"\r\n              disabled={loading}\r\n            >\r\n              {loading ? 'Loading...' : 'üîÑ Refresh'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Analytics Summary Cards */}\r\n      {analytics && (\r\n        <div className=\"summary-grid\" style={{ marginBottom: '30px' }}>\r\n          {/* Revenue Card */}\r\n          <div className=\"summary-item\" style={{ \r\n            background: 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',\r\n            color: 'white',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div className=\"summary-value\" style={{ fontSize: '2.5rem', color: 'white' }}>\r\n              ‡ß≥ {analytics.revenue.totalRevenueThisMonth.toFixed(0)}\r\n            </div>\r\n            <div className=\"summary-label\" style={{ color: 'rgba(255,255,255,0.9)' }}>\r\n              Revenue (This Month)\r\n            </div>\r\n            <div style={{ marginTop: '15px', fontSize: '0.9rem', opacity: 0.9 }}>\r\n              <div>Invoices: {analytics.revenue.invoiceCount}</div>\r\n              <div>Paid: {analytics.revenue.paidCount} | Unpaid: {analytics.revenue.unpaidCount}</div>\r\n              <div style={{ marginTop: '10px', paddingTop: '10px', borderTop: '1px solid rgba(255,255,255,0.3)' }}>\r\n                <div>Avg per invoice: ‡ß≥ {avgPerInvoice.toFixed(0)}</div>\r\n                <div>Avg per child: ‡ß≥ {avgPerChild.toFixed(0)}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Attendance Card */}\r\n          <div className=\"summary-item\" style={{ \r\n            background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',\r\n            color: 'white',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div className=\"summary-value\" style={{ fontSize: '2.5rem', color: 'white' }}>\r\n              {analytics.totalChildren}\r\n            </div>\r\n            <div className=\"summary-label\" style={{ color: 'rgba(255,255,255,0.9)' }}>\r\n              Total Children\r\n            </div>\r\n            <div style={{ marginTop: '15px', fontSize: '0.9rem', opacity: 0.9 }}>\r\n              <div>Avg attendance/week: {analytics.averageAttendancePerWeek.toFixed(1)}</div>\r\n              <div>Busiest hour: {analytics.busiestHour !== null ? `${analytics.busiestHour}:00` : 'N/A'}</div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Staff & Meals Card */}\r\n          <div className=\"summary-item\" style={{ \r\n            background: 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)',\r\n            color: 'white',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div className=\"summary-value\" style={{ fontSize: '2.5rem', color: 'white' }}>\r\n              {analytics.totalStaff}\r\n            </div>\r\n            <div className=\"summary-label\" style={{ color: 'rgba(255,255,255,0.9)' }}>\r\n              Total Staff\r\n            </div>\r\n            <div style={{ marginTop: '15px', fontSize: '0.9rem', opacity: 0.9 }}>\r\n              <div>Avg children per staff: {avgChildrenPerStaff}</div>\r\n              <div style={{ marginTop: '10px', paddingTop: '10px', borderTop: '1px solid rgba(255,255,255,0.3)' }}>\r\n                Meals: {analytics.mealConsumptionStats.map(m => `${m.meal}: ${m.count}`).join(', ') || 'N/A'}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Daily Occupancy Table */}\r\n      {analytics && analytics.occupancy && analytics.occupancy.length > 0 && (\r\n        <div className=\"form-container\" style={{ marginBottom: '30px' }}>\r\n          <h2 style={{ marginBottom: '20px' }}>üìÖ Daily Occupancy (Current Month)</h2>\r\n          <div style={{ overflowX: 'auto' }}>\r\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n              <thead>\r\n                <tr style={{ background: '#c89b9b', color: '#2d3748' }}>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Date</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Present</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Occupancy Rate</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {analytics.occupancy.map((row) => (\r\n                  <tr key={row.date} style={{ borderBottom: '1px solid #e2e8f0' }}>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>{row.date}</td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>{row.present}</td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>\r\n                      {(row.occupancyRate * 100).toFixed(1)}%\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Staff Workload Table */}\r\n      {analytics && analytics.staffWorkload && analytics.staffWorkload.length > 0 && (\r\n        <div className=\"form-container\" style={{ marginBottom: '30px' }}>\r\n          <h2 style={{ marginBottom: '20px' }}>üë• Staff Workload</h2>\r\n          <div style={{ overflowX: 'auto' }}>\r\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n              <thead>\r\n                <tr style={{ background: '#c89b9b', color: '#2d3748' }}>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Name</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Role</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Children Assigned</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Weekly Hours</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {analytics.staffWorkload.map((s, idx) => (\r\n                  <tr key={idx} style={{ borderBottom: '1px solid #e2e8f0' }}>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>{s.name}</td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0', textTransform: 'capitalize' }}>{s.role}</td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>{s.childrenAssignedCount}</td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>{s.weeklyHours}</td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Invoices Table */}\r\n      <div className=\"form-container\">\r\n        <h2 style={{ marginBottom: '20px' }}>üìã Invoices</h2>\r\n        {loading ? (\r\n          <div style={{ textAlign: 'center', padding: '40px' }}>\r\n            <p>Loading invoices...</p>\r\n          </div>\r\n        ) : invoices.length === 0 ? (\r\n          <div style={{ textAlign: 'center', padding: '40px', color: '#666' }}>\r\n            <p>No invoices found for the selected filters.</p>\r\n            <p style={{ fontSize: '0.9rem', marginTop: '10px' }}>\r\n              Click \"Generate Invoices for Current Month\" to create invoices.\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div style={{ overflowX: 'auto' }}>\r\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n              <thead>\r\n                <tr style={{ background: '#c89b9b', color: '#2d3748' }}>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Child</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Month/Year</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Days</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Base/Day</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Extra</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Total</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Status</th>\r\n                  <th style={{ padding: '12px', textAlign: 'left', border: '1px solid #a18a8a' }}>Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {invoices.map((inv) => (\r\n                  <tr key={inv._id} style={{ borderBottom: '1px solid #e2e8f0' }}>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>\r\n                      {inv.child?.name || 'Unknown'}\r\n                    </td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>\r\n                      {inv.month}/{inv.year}\r\n                    </td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>{inv.daysPresent}</td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>‡ß≥ {inv.baseRatePerDay}</td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>‡ß≥ {inv.extraCharges}</td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0', fontWeight: '600' }}>\r\n                      ‡ß≥ {inv.totalAmount}\r\n                    </td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>\r\n                      <span\r\n                        style={{\r\n                          padding: '4px 12px',\r\n                          borderRadius: '20px',\r\n                          fontSize: '0.85rem',\r\n                          fontWeight: '600',\r\n                          background: inv.status === 'paid' ? '#d1fae5' : '#fef3c7',\r\n                          color: inv.status === 'paid' ? '#065f46' : '#92400e'\r\n                        }}\r\n                      >\r\n                        {inv.status.toUpperCase()}\r\n                      </span>\r\n                    </td>\r\n                    <td style={{ padding: '10px', border: '1px solid #e2e8f0' }}>\r\n                      {inv.status === 'unpaid' && (\r\n                        <button\r\n                          onClick={() => handleMarkPaid(inv._id)}\r\n                          className=\"btn btn-primary\"\r\n                          style={{ padding: '6px 15px', fontSize: '0.9rem' }}\r\n                        >\r\n                          Mark Paid\r\n                        </button>\r\n                      )}\r\n                      {inv.status === 'paid' && (\r\n                        <span style={{ color: '#10b981', fontSize: '0.9rem' }}>‚úì Paid</span>\r\n                      )}\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BillingDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}